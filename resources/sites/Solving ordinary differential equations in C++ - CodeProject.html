<!DOCTYPE html>
<!-- saved from url=(0087)https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C -->
<html class="gr__codeproject_com" style="height: 100%;"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>Solving ordinary differential equations in C++ - CodeProject</title> 
	<link type="text/css" rel="stylesheet" href="./Solving ordinary differential equations in C++ - CodeProject_files/Main.min.css">

	
<meta http-equiv="content-language" content="en-US">

<meta name="Description" content="This article explains a framework for solving ordinary differential equations, which is based on template metaprogramming.; Author: headmyshoulder; Updated: 19 Oct 2011; Section: Algorithms &amp; Recipes; Chapter: General Programming; Updated: 19 Oct 2011">
<meta name="Keywords" content="C++, Windows, STL, Architect, Dev, Linux, Intermediate, Advanced,Algorithms &amp; Recipes,General Programming,Free source code, tutorials">
<meta name="Author" content="headmyshoulder">
<meta name="Rating" content="General">
<meta name="Revisit-After" content="1 days">
<meta name="application-name" content="CodeProject">
<meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13">

<link rel="dns-prefetch" href="https://ajax.googleapis.com/"> 



<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1">
<link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22">
<link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx">
<meta name="robots" content="index, follow">
<link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
<script src="./Solving ordinary differential equations in C++ - CodeProject_files/osd.js"></script><script src="./Solving ordinary differential equations in C++ - CodeProject_files/ads"></script><script src="./Solving ordinary differential equations in C++ - CodeProject_files/ads(1)"></script><script src="./Solving ordinary differential equations in C++ - CodeProject_files/ads(2)"></script><script async="" type="text/javascript" src="./Solving ordinary differential equations in C++ - CodeProject_files/gpt.js"></script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "headline": "Solving ordinary differential equations in C++",
  "url": "https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C",
  "discussionUrl": "https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/recipes/odeint/Thumb-43607.jpg",
  "keywords": "C++, Windows, Linux, STL, Architect, Dev",
  "commentCount": "50",
  "editor" : {
    "@type" : "Person",
    "name" : "Deeksha Shenoy",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3866010"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  }
  "description": "This article explains a framework for solving ordinary differential equations, which is based on template metaprogramming.",
  "upvoteCount": "32",
  "articleSection": "Algorithms & Recipes",
  "author" : [{
      "@type" : "Person",
      "name" : "headmyshoulder",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=1619496"
    }],
  "datePublished": "2009-11-10",
  "dateCreated": "2009-11-10",
  "dateModified": "2011-10-19",
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.82,
    "ratingCount" : 36,
    "bestRating" : 5,
    "worstRating" : 1
  },
}
</script>
<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/6/General-Programming.aspx",
      "name" : "General Programming"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/recipes/",
      "name" : "Algorithms & Recipes"
    }
  }]
}
</script>
	<!--<base target="_top">--><base href="." target="_top">
	<link rel="icon" href="https://www.codeproject.com/favicon.ico" type="image/ico">
<link rel="shortcut icon" href="https://www.codeproject.com/favicon.ico" type="image/ico">
<link rel="apple-touch-icon" href="https://www.codeproject.com/favicon.ico" type="image/png">
<script type="text/javascript" language="Javascript" src="./Solving ordinary differential equations in C++ - CodeProject_files/jquery.min.js"></script><script type="text/javascript">//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='%2fscript%2fJS%2fjquery-2.2.4.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));

//]]>
</script>

	




<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script><script type="text/javascript" async="" src="./Solving ordinary differential equations in C++ - CodeProject_files/ga.js"></script>


<link type="text/css" rel="stylesheet" charset="UTF-8" href="./Solving ordinary differential equations in C++ - CodeProject_files/translateelement.css"><script type="text/javascript" charset="UTF-8" src="./Solving ordinary differential equations in C++ - CodeProject_files/main.js"></script><style type="text/css">.backpack.dropzone {
  font-family: 'SF UI Display', 'Segoe UI';
  font-size: 15px;
  text-align: center;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  width: 250px;
  height: 150px;
  font-weight: lighter;
  color: white;
  will-change: right;
  z-index: 2147483647;
  bottom: 20%;
  background: #333;
  position: fixed;
  user-select: none;
  transition: left .5s, right .5s;
  right: 0px; }
  .backpack.dropzone .animation {
    height: 80px;
    width: 250px;
    background: url("https://sxt.cdn.skype.com/assets/dropzone/hoverstate.png") left center; }
  .backpack.dropzone .title::before {
    content: 'Save to'; }
  .backpack.dropzone.closed {
    right: -250px; }
  .backpack.dropzone.hover .animation {
    animation: sxt-play-anim-hover 0.91s steps(21);
    animation-fill-mode: forwards;
    background: url("https://sxt.cdn.skype.com/assets/dropzone/hoverstate.png") left center; }

@keyframes sxt-play-anim-hover {
  from {
    background-position: 0px; }
  to {
    background-position: -5250px; } }
  .backpack.dropzone.saving .title::before {
    content: 'Saving to'; }
  .backpack.dropzone.saving .animation {
    background: url("https://sxt.cdn.skype.com/assets/dropzone/saving_loop.png") left center;
    animation: sxt-play-anim-saving steps(59) 2.46s infinite; }

@keyframes sxt-play-anim-saving {
  100% {
    background-position: -14750px; } }
  .backpack.dropzone.saved .title::before {
    content: 'Saved to'; }
  .backpack.dropzone.saved .animation {
    background: url("https://sxt.cdn.skype.com/assets/dropzone/saved.png") left center;
    animation: sxt-play-anim-saved steps(20) 0.83s forwards; }

@keyframes sxt-play-anim-saved {
  100% {
    background-position: -5000px; } }
</style><script type="text/javascript" charset="UTF-8" src="./Solving ordinary differential equations in C++ - CodeProject_files/element_main.js"></script><script src="./Solving ordinary differential equations in C++ - CodeProject_files/pubads_impl_140.js" async=""></script></head>	

<body class="chrome chrome59" data-gr-c-s-loaded="true" style="position: relative; min-height: 100%; top: 0px;">

<a class="access-link" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#Main"><img alt="Click here to Skip to main content" src="./Solving ordinary differential equations in C++ - CodeProject_files/t.gif"></a>





<div class="page-background">

	
	

	

	
    <div id="ctl00_STM" class="site-top-menu fixed">
        <div class="main-content">
            

<div class="container memberbar clearfix">

	<div id="ctl00_MemberMenu_GenInfo" class="float-left">13,066,717 members (63,425 online)</div>

	<div class="float-left">
		
	</div>

	<div class="float-right">

		

		

		

			<script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C"
				else
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C"
				document.subForm.submit();
				return true;
			}//-->
			</script>

			<a name="SignUp"></a>
			<span class="member-signin tooltip openable">
				<span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C">Sign in</a></span>

				<div class="tooltip-flyout">
					<form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C" method="post" class="tight">

						
						<input id="FormName" name="FormName" value="MenuBarForm" type="hidden">

						<div>Email</div>
						<div><input class="small-text" type="email" name="Email" id="Email"></div>
						<div>Password</div>
						<div><input class="small-text" type="password" name="Password" id="Password"></div>
						<div class="action">
							
                                  <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join" style="visibility: visible;">
                                  <input type="hidden" name="fld_quicksign" value="true">
                                  <script type="text/javascript">
                                  function simpleMask(str, key) {
                                      var result = ''; 
                                      for (var i = 0; i < str.length; ++i)
                                          result += String.fromCharCode(key ^ str.charCodeAt(i));
                                      return result;
                                  }
                                  function Join() {
                                      var url = 'https://www.codeproject.com/script/Membership/Modify.aspx';
document.location.href=url;
                                      return false;
                                  }
                                  $('#joinBtn').css('visibility', 'visible');
                                  </script>
							<input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);">
						</div>

						<div class="container">
							
							&nbsp;
							<a id="ctl00_MemberMenu_SendPassword" class="forgot float-right" href="https://www.codeproject.com/script/Membership/SendPassword.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Forgot your password?</a>
						</div>
					</form>

					<hr class="divider-dark">

					Sign in with <a class="oauth" title="Sign in using Github" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Linkedin" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Facebook" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Google" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>
<a class="oauth" title="Sign in using Microsoft" href="https://www.codeproject.com/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;"></a>

				</div>
            </span>
		
	</div>
</div>
        </div>
    </div>

	
    <div id="ctl00_SH" class="site-header fixed">
        <div class="main-content">
            <div class="logo"><a href="https://www.codeproject.com/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="./Solving ordinary differential equations in C++ - CodeProject_files/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a></div>
            <div class="promo"><div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Math" data-tags="C++, Windows, STL, Architect, Dev, Linux, Intermediate, Advanced,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=728x90&amp;c=403565"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=728x90&amp;c=403565"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math-1" data-google-query-id="COKX2rTMvNUCFRwZjgodF8wGvA" style="height: 90px; width: 728px; box-sizing: border-box; border: 0px; font-size: 0px;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_0__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_0" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_0" width="728" height="90" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" src="./Solving ordinary differential equations in C++ - CodeProject_files/saved_resource.html"></iframe></div></div></div></div>
        </div>
    </div>

	<a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#Main"><img alt="Click here to Skip to main content" class="access-link" src="./Solving ordinary differential equations in C++ - CodeProject_files/t.gif"></a>

	
	<div id="ctl00_TPR" class="sub-headerbar clearfix fixed">
    <div class="float-right">
		

<div class="searchbar">

<form method="get" action="https://www.codeproject.com/search.aspx?sbo=kw" name="Search" class="tight">


<table border="0" cellspacing="0" cellpadding="0" class="search"><tbody><tr><td><input tabindex="2" class="search  subdue" id="sb_tb" value="" name="q"></td><td><input type="image" src="./Solving ordinary differential equations in C++ - CodeProject_files/search.gif"></td></tr></tbody></table>

<div class="hover-container">
	<div id="SearchFilter" class="search-advanced small-text align-left" style="display: none;">
	<b>Search within:<br></b>
		
		<input type="radio" id="sb_kw" name="sbo" value="kw" checked="true"><label for="sb_kw">Articles</label><br>
<input type="radio" id="sb_qa" name="sbo" value="qa"><label for="sb_qa">Quick Answers</label><br>
<input type="radio" id="sb_fm" name="sbo" value="fm"><label for="sb_fm">Messages</label><br>


		
		

		
		
	</div>
</div>
</form>

</div>
    </div>
    <div class="float-left">
		

<div class="navbar clearfix">
<ul class="navmenu openable">

<li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com/">home</a>


</li><li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="https://www.codeproject.com/script/Articles/Latest.aspx">articles</a>

	<ul>
		<li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, &#39;ctl00_TopNavBar_MapFlyout&#39;);" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a><ul id="ctl00_TopNavBar_MapFlyout">
			<li>
				<div id="siteMap">
					<img src="./Solving ordinary differential equations in C++ - CodeProject_files/loading48.gif" alt="loading" style="margin:150px;width:100px;height:100px;">
				</div>
			</li>
			</ul>
		</li>
		<li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="https://www.codeproject.com/search.aspx?sbo=kw">Search</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="https://www.codeproject.com/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li>
		<li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="https://www.codeproject.com/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="https://www.codeproject.com/search.aspx?sbo=kw?aidlst=152&amp;sa_us=True">Beginner Articles</a></li>
		<li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="https://www.codeproject.com/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li>
		<li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="https://www.codeproject.com/info/Submit.aspx">Posting/Update Guidelines</a></li>
		<li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_ArtCompetition" class="fly break" href="https://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1">Article Competition</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="https://www.codeproject.com/script/Articles/Submit.aspx">
			<img src="./Solving ordinary differential equations in C++ - CodeProject_files/write13.png" width="13px" height="13px"> Submit an article or tip
			</a></li>
		<li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="https://www.codeproject.com/script/Articles/BlogFeed.aspx">
			<img src="./Solving ordinary differential equations in C++ - CodeProject_files/write13.png" width="13px" height="13px"> Post your Blog
			</a></li>		<li class="last"></li>
	</ul>

</li>



<li class="openable">
<a id="ctl00_TopNavBar_Answers" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">
    <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span>
</a>
	<ul>
		<li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#_comments">
			<img src="./Solving ordinary differential equations in C++ - CodeProject_files/write13.png" width="13px" height="13px"> Ask a Question about this 
			article</a>
		</li>

		<li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="https://www.codeproject.com/Questions/ask.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/write13.png" width="13px" height="13px"> Ask a Question</a></li>

		
		<li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li>
		<li><a id="ctl00_TopNavBar_QALatest" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active">View All Questions...</a></li>
		
				<li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">C# questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">SQL questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li>
			
				<li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="https://www.codeproject.com/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">Javascript questions</a></li>
			
		<li class="last"></li>
	</ul>

</li>



<li class="openable"><a id="ctl00_TopNavBar_Forums" href="https://www.codeproject.com/script/Forums/List.aspx">
        <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="https://www.codeproject.com/script/Forums/List.aspx">All Message Boards...</a></li>
		<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3304/Work-Issues.aspx">Work  Issues</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/12076/ASP-NET.aspx">ASP.NET</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1580226/JavaScript.aspx">JavaScript</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/4486/ATL-WTL-STL.aspx">ATL /  WTL / STL</a></li>
<li><a class="fly" href="https://www.codeproject.com/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1649/Csharp.aspx">C#</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1627782/Free-Tools.aspx">Free Tools</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1725/Database.aspx">Database</a>
</li>
<li class="openable"><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a>
<ul class="openable"><li><a class="fly" href="https://www.codeproject.com/Forums/1644/System-Admin.aspx">System Admin</a></li>
</ul></li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1643/Java.aspx">Java</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1650/NET-Framework.aspx">.NET Framework</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1848626/Android.aspx">Android</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1876716/iOS.aspx">iOS</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/13695/Mobile.aspx">Mobile</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1540733/SharePoint.aspx">SharePoint</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1646/Visual-Basic.aspx">Visual Basic</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1640/Web-Development.aspx">Web Development</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/suggestions.aspx">Site Bugs / Suggestions</a>
</li>
<li><a class="fly" style="padding-left:30px" href="https://www.codeproject.com/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a>
</li>

		<li class="last"></li>
	</ul>

</li>

<li class="openable desktop-only"><a id="ctl00_TopNavBar_Features" href="https://www.codeproject.com/Feature/">features</a>

	<ul>
		<li><a id="ctl00_TopNavBar_Comps" class="fly" href="https://www.codeproject.com/script/Awards/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</a></li>
		<li><a id="ctl00_TopNavBar_News" class="fly" href="https://www.codeproject.com/script/News/List.aspx">News</a></li>
		<li><a id="ctl00_TopNavBar_Insider" class="fly" href="https://www.codeproject.com/Feature/Insider/">The Insider Newsletter</a></li>
    	<li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="https://www.codeproject.com/Feature/DailyBuild">The Daily Build Newsletter</a></li>
		<li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="https://www.codeproject.com/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li>
		<li><a id="ctl00_TopNavBar_Surveys" class="fly" href="https://www.codeproject.com/script/Surveys/List.aspx">Surveys</a></li>
		<li><a id="ctl00_TopNavBar_Showcase" class="fly" href="https://www.codeproject.com/KB/showcase/">Product Showcase</a></li>
		<li><a id="ctl00_TopNavBar_Research" class="fly" href="https://www.codeproject.com/script/ResearchLibrary/Index.aspx">Research Library</a></li>

		<li><a id="ctl00_TopNavBar_Stuff" class="fly" href="https://www.codeproject.com/Info/Stuff.aspx">CodeProject Stuff</a></li>
		<li class="last"></li>
	</ul>

</li>


<li class="openable"><a id="ctl00_TopNavBar_Lounge" href="https://www.codeproject.com/Lounge.aspx">
            <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span>
</a>

	<ul>
		<li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="https://www.codeproject.com/script/Membership/Profiles.aspx">Who's Who</a></li>
		<li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="https://www.codeproject.com/script/Awards/MVPWinners.aspx">Most Valuable Professionals</a></li>
		

		<li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="https://www.codeproject.com/Lounge.aspx">The Lounge &nbsp;</a></li>
		<li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="https://www.codeproject.com/Insider.aspx">The Insider News</a></li>
		<li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="https://www.codeproject.com/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li>
		<li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="https://www.codeproject.com/Forums/1536756/The-Soapbox.aspx">The Soapbox</a></li>
		<li><a id="ctl00_TopNavBar_PRLnk" class="fly break" href="https://www.codeproject.com/Forums/1738007/Press-Releases.aspx">Press Releases</a></li>

		
		<li class="openable"><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">Non-English Language
			<span class="has-submenu">&gt;</span></a>
		<ul>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580229/Hindi.aspx">General Indian Topics</a></li>
		<li><a class="fly" href="https://www.codeproject.com/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li>
		</ul>
		</li><li class="last"></li>
		
	</ul>

</li>


<li class="openable desktop-only tablet-only" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="https://www.codeproject.com/KB/FAQs/">help</a>

	<ul>
		<li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="https://www.codeproject.com/info/guide.aspx">What is 'CodeProject'?</a></li>
		<li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="https://www.codeproject.com/KB/FAQs/">General FAQ</a></li>
		<li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="https://www.codeproject.com/Questions/ask.aspx">Ask a Question</a></li>
		<li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="https://www.codeproject.com/suggestions.aspx">Bugs and Suggestions</a></li>
		<li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="https://www.codeproject.com/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li>
		<li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="https://www.codeproject.com/script/Content/SiteMap.aspx">Site Map</a></li>
		<li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="http://developermedia.com/">Advertise with us</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutAds" class="fly" href="https://www.codeproject.com/info/AboutOurAds.aspx">About our Advertising</a></li>
		<li><a id="ctl00_TopNavBar_HelpJobs" class="fly" href="https://www.codeproject.com/info/Jobs/">Employment Opportunities</a></li>
		<li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="https://www.codeproject.com/info/about.aspx">About Us</a></li>
		<li class="last"></li>
	</ul>

</li>

</ul>

</div>
    </div>
	<div class="sub-headerbar-divider"></div>
	</div>		
	

	<div id="A" class="container-content-wrap fixed"> 
	<div class="container-content">


		<div class="clearfix">
			<div class="container-breadcrumb float-left ">
				<div><a href="https://www.codeproject.com/script/Content/SiteMap.aspx">Articles</a> » <a href="https://www.codeproject.com/Chapters/6/General-Programming.aspx">General Programming</a> » <a href="https://www.codeproject.com/KB/recipes/">Algorithms &amp; Recipes</a> » <a href="https://www.codeproject.com/KB/recipes/#Math">Math</a></div>
			</div>

            

			<div class="edit-links float-right">
				


 
&nbsp;










			</div>

			<div class="article-nav float-right">
                
				

<div style="display:inline-block;position:relative;top:-6px;margin-right:20px">
    
</div>



<a id="ctl00_ActionLinks_BookmarkMd_ImgBt" title="Bookmark" alternatetext="Bookmark" name="bm_43607_2" onclick="return bookmarkMe(43607,2,&#39;/script/Bookmarks/Ajax/Add.aspx?obid=43607&amp;obtid=2&amp;bio=true&amp;bis=medium&#39;,&#39;medium&#39;);" href="https://www.codeproject.com/script/Bookmarks/Add.aspx?obid=43607&amp;obtid=2&amp;bio=true&amp;bis=medium" style="display:inline-block;height:24px;width:24px;"><img title="Bookmark" src="./Solving ordinary differential equations in C++ - CodeProject_files/bookmark24.png" alt="" style="border-width:0px;"></a>


<span id="ctl00_ActionLinks_BookmarkMd_StatusMsg" class="tiny-text" style="display:none" name="bm_43607_2"></span>
<a id="ctl00_ActionLinks_PrintMd" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?display=Print">
	    <img src="./Solving ordinary differential equations in C++ - CodeProject_files/print24.png" title="Print" width="24px" height="24px" style="border:0">
    </a>
			</div>
		</div>

		<table class="extended container-article-parts" cellpadding="0" cellspacing="0">
        <tbody><tr valign="top">
		<td width="117px" class="article-wing-left">

			<div id="ctl00_Nav" class="container-article-tabs" style="position: static; top: 231px; left: 433.5px;">
    			

<div class="tabs">
	<div class="selected">Article</div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ViewDownloads.aspx?aid=43607">Browse Code</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/Statistics.aspx?aid=43607">Stats</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ListVersions.aspx?aid=43607">Revisions (10)</a></div><div class="unselected"><a href="https://www.codeproject.com/script/Articles/ListAlternatives.aspx?aid=43607">Alternatives</a></div>

	<div class="unselected"><a href="https://www.codeproject.com/Articles/43607/WebControls/#_comments" id="ctl00_ArticleTabs_CommentLink" class="anchorLink">Comments 
        <span id="ctl00_ArticleTabs_CmtCnt">(50)</span></a>
	</div>
</div>	


				<a id="ctl00_AddAlternative" title="Write a related article about upgrades or translate this into a different language." class="add-item" href="https://www.codeproject.com/script/Articles/SubmissionWizard.aspx?at=1&amp;apid=43607">Add your own<br>alternative version</a>

			    <div>
                    <h4>Tagged as</h4>
			        <span id="ctl00_TagList_TagWrp" class="tags vertical">

	
	

	
	<span id="ctl00_TagList_VisibleTags"><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/C--plus----plus--" data-id="78">C++</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Windows" data-id="94">Windows</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/STL" data-id="110">STL</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Architect" data-id="116">Architect</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Dev" data-id="118">Dev</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Linux" data-id="120">Linux</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Intermediate" data-id="153">Intermediate</a></div><div class="t"><a rel="tag" href="https://www.codeproject.com/Tags/Advanced" data-id="154">Advanced</a></div></span> 

	
	
</span>


			    </div>

                <div class="stats">
                <h4>Stats</h4>
                <div id="ctl00_ArtStats"><div class="stats"><div>178.6K views</div><div>2.8K downloads</div><div>96 bookmarked</div></div></div>
                </div>

                <div class="subdue padded-top" title="Date First posted">Posted 
                    9 Nov 2009</div>

                <div title="Licence">
                    <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a>
                </div>

                
			</div>

		</td>
		<td>
			
			<div id="AT" class="container-article  fixed"> 

				<div class="article">

					<form name="aspnetForm" method="post" action="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C" id="aspnetForm" style="margin:0;padding:0">
<div>
<input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="qGCJZe3gkRR12qPyxf+Wi3Z3DmBnIhNsxBCHT2A/tZ/5NvOCXLPIlBWB19vKT8MTFK1iotp9yehmoT42IprL67HLq5CYykQxykXGQwq1jlyR4aw61cBoN4zb99Ulr+PWu6t2Pju7B3A5IspIW2JTDCTrIrF7G9r1CeFaqS8W0c+5nGW35rWnlr+n5v6oe9io1X5iv9saons0KzsmYzfKkEILqavBDOQGz0HRdYSEZlPYU0nTZt3g4MYE603UzlQpNLSGjwNfd5HAc6w59Kd0H3Wo7WDy2qs0jSAFF1LELJN8Rafj5ZbqD/dDnHaXKBYhPiqQYU2T3b/1nzbUbBuyu/RQRAQim3lr79rfYMSrvK5LPuH/JoLaG1LbqmgjjtbyvPNeliGJqFzViyGAFOuA1scCyIEibBODpi8xt819iRA/4eyib3iMMs2Y32WdA9tB4n4kYPJ9S43RJG+Yxeawrb2V5fZNtSG+sVHV2DgfXin83GDVqmfO79KZQ0gJMqjV0VeWap+7Z0NYG3PsEsfoabKjjUlCyTB6XBns6Nx8dezqGjVSKq32fq56lOr8O7V1MyWrcxgdKXLBgTm1K6b/sK7ggaZw3YwP35UkETsph9VEdGWXYyEqpBtU2oRjUYrADoDJSSceGdLzfgpZB/YGERcE9l3qkOVmwqkM1RQG3rojCLUkrWWKa2iTQBZDkxRf1OIlWhv8mAucqlGGqerKSzK3epDa9Ber/X+6rnHmAZg/E4ZCZ8k26B+udwTFQIGiu5YjhL2Bn39cP4E3BjYTU3813bMLyVTSL+X3FAaOY1YJdr1oEh4/h16y73dBI1JXkIh4HAMzf2eMHt+xKsqKcSYac1M2a/gR5fN98/MV/ZzAb7kHk7fDkhqLVNPvKEnnyiBMXKgdevGAA/lGwjMvpk5H+zYbitPf33t/46zqLfEL4RV6Qhc9kcNUX7dWe72EekPI3XDKo+1h53Eo9s1ZBrGL72GfsvTebjoujhBki8kPOLfmC82cNN0K4unuklVEgPYRarVqdSV++0V8MCTyxNqdOELqrrrcC28o1mzALc7GYcSH2hfF3rc02cganl/8mqhL8EjvQ+pmUHmrqITegMhcroJj03s0kbdqVp56/KRgNWpoSgY2RCNXhpMom4TYJMzSA3DAHHPFud6i+aizQcaBRbDUP2XI05hdfZGv/bkDeZKC5Tw0Wc/VWh3a7gQwN17I+syTjNbwDrYvc7lRHIAC5o1iIay0P0lmmei7MBZspdmybF6UEntIeCwRHEZJy/1ApXLQt1CsQkdgwTXgjuRuMM9Zrphi8GAiRNGdk1bWipp3iVtrcgjGyzOYNdZtHdN9+FkdzeInTxAHrM6YB1i4o+sKm4S3NdH+odJALuNUCt8I5p3Zhxb6R5/4tVQKNf9SG4d5JBHsc6UBJ1KYmeOnaxU5y5SH8PlEsZZ5cWIIEMDenC5WWt+4H+JT0Fdm/ShqeBz2r0kQ2AUgSgonCUHYXokCE/49U+PAdLG0jPfB6vsfBch6elbXl+gTO6hHApW4UPmQq+l9UrufCH31Jqh+5ACMabZegwmpz3BADk05Q3C/qO8AMV8uoBnZsIXwe776UjP2uprXpKmT4t2t67YAWn0/ZOjRqyPJ46U8NHwb1SaCUnflP8HjVq6pDPzqS9mt6U6cdNL+R0zrAs5307y2wQ1XQy+cgWDOCOqvNZ5VynaRGQFlSWLS4d+I90LJNvCBsp7A3GzyzMKWS0i8ZEaJzOsCtkFtZ03f5S3B5iUU2eAs0+xFph8Bm1O/FFl6ejg8fZeCmRNAz3vPfHdtS0Dl5LC2MfRfIff8r04P6Tp6FRMlCwyvcyIS0IsfQLwFXL5Fzjc+KFaaAqLHnS/9EgxuDBXFhfFYmJWE4HcNOhurxYHqYQriLIEeFPWulr1IK/xJqKUD0ocn/oNDJpIFUsWRjHECyof4aeWXFNZs+8M5Osn0dUVy9Nqbm3zEuZEsaQCGvnm7GE3zxIL7FkwGWz55t2pl6H2doJmchSivQ+1iUgO/+SmWSBH/L1wSUFOqCcmDrauOLEt0HrDCgh4+qJDhD7XGnmm3u1dCtlVIStNwlieq">
</div>

<div>

	<input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69">
</div>

					
					 
					<div class="header">
					    <a name="Main"></a>

					    
					    <a name="_articleTop" id="_articleTop"></a>
					    <div class="title">
					        <h1 id="ctl00_ArticleTitle">Solving ordinary differential equations in C++</h1>
					    </div>

                        <div style="height:34px">
					        
					        <div class="entry float-left">

                                

                                <div class="float-left">
                                    <div>
						                <span class="author"><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496" rel="author">headmyshoulder</a></span>, 
						                <span class="date" title="Date last updated">
							            19 Oct 2011</span>
			                        </div>

                                    
						            <div id="ctl00_RateArticleRow" class="float-left align-right" style="margin-top:5px">

					                    <div id="ctl00_CurRat" class="tooltip anchorLink column" style="cursor:pointer;margin:2px 20px 0 0" name="CurRat_43607">
				
							                

<table id="ctl00_ArticleRating_RatingTable" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td class="nowrap">

		<span id="ctl00_ArticleRating_VI">
		<div class="nowrap rating-stars-medium" style="height:18px;width:80px;position:relative;">
			<div class="clipped align-left float-left" style="height:16px;width:77px;">
				<img src="./Solving ordinary differential equations in C++ - CodeProject_files/stars-fill-md.png" style="border-width:0px;">
			</div><div class="clipped" style="height:16px;width:3px;position:relative;">
				<img src="./Solving ordinary differential equations in C++ - CodeProject_files/stars-empty-md.png" style="border-width:0px;position:absolute;top:0;right:0;">
			</div>
		</div>
		</span>

		
	</td>
		<td id="ctl00_ArticleRating_VR" class="nowrap">
		&nbsp;
		<span id="ctl00_ArticleRating_VotesR">&nbsp;4.82 (36 votes)</span>
		
	</td>
	</tr>
</tbody></table>

<span id="ctl00_ArticleRating_RatingText"></span>


							                <div id="ctl00_RB" class="speech-bubble-container-up">
								                <div class="speech-bubble-up" style="width:150px !important">
									                            
<div>
<table class="feature" width="100%" height="50px" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0"><tbody><tr class="chart-row"><td class="chart-column"><div class="rating-ignore-vote" title="Votes not included in score."><img src="./Solving ordinary differential equations in C++ - CodeProject_files/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="1 vote, 3.1%" title="1 vote, 3.1%"></div><span title="0 votes">1</span></td>
<td class="chart-column"><span title="0 votes">2</span></td>
<td class="chart-column"><div class="rating-ignore-vote" title="Votes not included in score."><img src="./Solving ordinary differential equations in C++ - CodeProject_files/pollcol.gif" width="20pxpx" height="5px" border="0px" alt="3 votes, 9.4%" title="3 votes, 9.4%"></div><span title="0 votes">3</span></td>
<td class="chart-column"><div><img src="./Solving ordinary differential equations in C++ - CodeProject_files/pollcol.gif" width="20pxpx" height="7px" border="0px" alt="4 votes, 12.5%" title="4 votes, 12.5%"></div><span title="4 votes">4</span></td>
<td class="chart-column"><div><img src="./Solving ordinary differential equations in C++ - CodeProject_files/pollcol.gif" width="20pxpx" height="50px" border="0px" alt="28 votes, 87.5%" title="28 votes, 87.5%"></div><span title="28 votes">5</span></td>
</tr></tbody></table><div class="small-text align-center">4.82/5 - 36 votes</div><div class="small-text align-center subdue">4 removed</div><div class="small-text align-center subdue">μ 4.59, σ<sub>a</sub> 1.39 [<a href="https://www.codeproject.com/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]</div>
</div>
								                </div>
								                <div class="speech-bubble-pointer-up">
									                <div class="speech-bubble-pointer-up-inner"></div>
								                </div>
							                </div>

						                </div>
                                        <div class="column">
                                        <div id="ctl00_RateArticle_RateItemWrapper" class="small-text" name="RateItem_43607">

	<table width="100%" cellpadding="0" cellspacing="0" class="small-text">
	<tbody><tr>
		<td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right">
			<span class="align-right"></span>
			<img class="loading invisible" width="16px" alt="loading..." height="16px" src="./Solving ordinary differential equations in C++ - CodeProject_files/loading16.gif"> 
		</td>

	
		<td class="voteTbl" style="white-space:nowrap" align="right">
			<table class="small-text">
			<tbody><tr>
				<td id="ctl00_RateArticle_RateText" class="rating-prompt">
					Rate this:
				</td>

				
				<td id="ctl00_RateArticle_VoteFormDiv" class="nowrap rating-stars-voter-medium">
					

					<span id="ctl00_RateArticle_RB" class="tooltip ajaxHist radio voting">
						<span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4" style="display: none;"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5" style="display: none;"></span> 

						
					<div class="rating-star-block"><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#" rating="1" class="star outline" title="vote 1">vote 1</a><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#" rating="2" class="star outline" title="vote 2">vote 2</a><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#" rating="3" class="star outline" title="vote 3">vote 3</a><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#" rating="4" class="star outline" title="vote 4">vote 4</a><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#" rating="5" class="star outline" title="vote 5">vote 5</a></div></span>

				</td>

				
				<td style="padding-left:5px">	
					<input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button" style="display: none;">
				</td>
			</tr>
			</tbody></table>
			
		</td>
	</tr>
	</tbody></table>
	<div class="hover-container">
		
        <div id="ctl00_RateArticle_RSU" class="rating-comment align-left float-right">
            <div class="padded">
            Please <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C">Sign up or sign in</a> to vote.
            </div>
        </div>
	</div>
</div>
                                        </div>
                                    
                                    </div>
    						        	

                                </div>

    	                        	
                                <div class="float-left" style="margin: 25px 0 0 10px;">
	                                
	                            </div>
                         	    	
    
					        </div>

                            

						    <div class="float-right align-center">
                                <div class="msg-210x60" data-format="210x60" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Math" data-tags="C++, Windows, STL, Architect, Dev, Linux, Intermediate, Advanced,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=210x60&amp;c=559694"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=210x60&amp;c=559694"  width="210px" height="60px" target="_blank"/&gt;&lt;/a&gt;</noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math-2" data-google-query-id="COzj2rTMvNUCFV1zjgodlf8GOA" style="height: 0px; width: 0px; box-sizing: border-box; border: 0px; font-size: 0px; display: none;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_1__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_1" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_1" width="210" height="60" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" src="./Solving ordinary differential equations in C++ - CodeProject_files/saved_resource(1).html"></iframe></div></div></div>
						    </div>

                        </div>

                        <div id="ctl00_description" class="summary">This article explains a framework for solving ordinary differential equations, which is based on template metaprogramming.</div><span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/KB/recipes/odeint/Thumb-43607.jpg"></span>			

                    </div>
                    
					
					

					

					
					
					

						
					

					

						
						<div id="contentdiv" class="text">
						



<ul class="download">
<li><a href="https://www.codeproject.com/KB/recipes/odeint/odeint.zip">Download source code -&nbsp;40.57 KB</a> </li>
</ul>

<p><strong>Attention:</strong> A new version of <strong>odeint</strong> exists, which is decribed <a href="https://www.codeproject.com/KB/recipes/odeint-v2.aspx">here</a>. </p>

<h2>Introduction</h2>

<p>This article introduces the C++ framework <strong>odeint</strong> for solving ordinary differential equations (ODEs), which is based on template meta-programming. I think this framework has some nice advantages over existing code on ODEs, and it uses templates in a very elegant way. Furthermore, <strong>odeint</strong> has a STL-like syntax, and is independent of a specific container. The whole project lives in the <a href="https://svn.boost.org/svn/boost/sandbox/odeint/">boost sandbox</a>; the code presented here is more or less a snapshot of the current development.</p>

<h2>Background</h2>

<p>I will only very briefly describe ordinary differential equations. If there is some interest in a more detailed explanation of ODEs, I can extend this part in future versions of the article.</p>

<h3>Ordinary Differential Equations</h3>

<p>An ordinary differential equation describes the evolution of some quantity x in terms of its derivative. It often takes the form:</p>

<div class="pre-action-link" id="premain139838" style="width:100%;display:block;"><span id="prehide139838" onclick="processCodeBlocks.togglePre(139838);">Hide</span>  &nbsp; <span id="copycode139838" onclick="return processCodeBlocks.copyCode(139838);">Copy Code</span></div><pre lang="text" id="pre139838" class="notranslate" style="margin-top: 0px;">d x(t) / d t = f( x(t) , t )</pre>

<p>The function f defines the ODE, and x and f can be vectors. Associated with every ODE is an initial value problem (IVP) that is the ODE, and an initial value x(t0)=x0. The solution of the initial value problem is the temporal evolution of x(t), with the additional condition that x(t0)=x0, and it can be shown that every IVP has a unique solution. Of course, ordinary differential equations are not restricted to temporal problems, hence the variable <em>t</em> can be replaced by another quantity, like a spatial coordinate. ODEs and their relative PDEs (partial differential equation) are very important in nearly all scientific disciplines. All major equations in physics fall in this class, like Newton's law for classical physics, the Maxwell's equations for electromagnetism, the Schrödinger equation and its relativistic generalizations for the quantum world, or Einstein's equation for general relativity. Very often, the spatial axes of a PDE are discretized, and an ODE on a lattice results.</p>

<p>In the following figure, an example of an ODE from chaos theory is shown: the famous Lorenz attractor. It was the first example of a deterministic chaotic system, and triggered a huge amount of scientific work. The Lorenz attractor is described by a set of coupled ordinary differential equations:</p>

<div class="pre-action-link" id="premain250387" style="width:100%;display:block;"><span id="prehide250387" onclick="processCodeBlocks.togglePre(250387);">Hide</span>  &nbsp; <span id="copycode250387" onclick="return processCodeBlocks.copyCode(250387);">Copy Code</span></div><pre lang="text" id="pre250387" class="notranslate" style="margin-top: 0px;">d x1 / dt = sigma * ( x2 - x1 )
d x2 / dt = R * x1 - x2 - x1 * x3
d x3 / dt = x1 * x2 - b * x3</pre>

<p>with:</p>

<div class="pre-action-link" id="premain74003" style="width:100%;display:block;"><span id="prehide74003" onclick="processCodeBlocks.togglePre(74003);">Hide</span>  &nbsp; <span id="copycode74003" onclick="return processCodeBlocks.copyCode(74003);">Copy Code</span></div><pre lang="text" id="pre74003" class="notranslate" style="margin-top: 0px;">sigma = 10
R = 28
b = 8 / 3</pre>

<p>This equation has no analytical solution, such that it can only be solved numerically.</p>
<img width="600" height="284" alt="lorenz_const_step.jpg" src="./Solving ordinary differential equations in C++ - CodeProject_files/lorenz_const_step.jpg"> 
<h3>Numerical Solutions of ODEs</h3>

<p>To solve ODEs numerically, various methods exist; all of them discretize the time. The easiest method is surely the explicit Euler scheme, which writes the derivative as the difference quotient:</p>

<div class="pre-action-link" id="premain951738" style="width:100%;display:block;"><span id="prehide951738" onclick="processCodeBlocks.togglePre(951738);">Hide</span>  &nbsp; <span id="copycode951738" onclick="return processCodeBlocks.copyCode(951738);">Copy Code</span></div><pre lang="text" id="pre951738" class="notranslate" style="margin-top: 0px;">d x(t) / d t = x(t+dt) - x(t) / dt</pre>

<p>Then, some basic algebraic manipulations yield:</p>

<div class="pre-action-link" id="premain321190" style="width:100%;display:block;"><span id="prehide321190" onclick="processCodeBlocks.togglePre(321190);">Hide</span>  &nbsp; <span id="copycode321190" onclick="return processCodeBlocks.copyCode(321190);">Copy Code</span></div><pre lang="text" id="pre321190" class="notranslate" style="margin-top: 0px;">x(t+dt) = x(t) + dt*f (x(t) , t )</pre>

<p>such that x(t+dt) can be obtained from the knowledge of x at the time t. Note again, that x does not have to be a scalar, but can be a vector. The rest is very simple. One chooses an initial condition x(t=0)=x0, and iteratively applies the Euler step to x(t) to obtain the evolution of x(t). Of course, more advanced solvers exist, and the most commonly used solver is probably the Runge-Kutta method of fourth order.</p>

<p>In the following source code, the function f(x(t)) defining the ODE is synonymously called system or dynamical system.</p>

<h2>The Main Ideas</h2>

<p>Now, we come to the design aspects of the library. One clearly needs two main building blocks:</p>

<ol>
<li>A stepper function, which calculates the state x(t+d t) from the knowledge of x(t). </li>

<li>An integrate function, which performs the iteration, hence applies the stepper function many times. </li>
</ol>

<p><strong>The whole library lives in the namespace <code>boost::odeint::numeric</code></strong>.</p>

<h3>Stepper Methods</h3>

<p>We try to avoid <code>abstract </code>classes, since this costs some extra performance. Instead, we use generic programming and concepts which describe how a type or class has to behave, and whose methods have to be available. For the stepper function, we need the following ingredients:</p>

<div class="pre-action-link" id="premain846877" style="width:100%;display:block;"><span id="prehide846877" onclick="processCodeBlocks.togglePre(846877);">Hide</span>  &nbsp; <span id="preShrink846877" onclick="processCodeBlocks.shrinkExpand(846877);">Shrink</span> <img id="preimg846877" src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(846877);">  &nbsp; <span id="copycode846877" onclick="return processCodeBlocks.copyCode(846877);">Copy Code</span></div><pre lang="C++" id="pre846877" processed="true" class="notranslate" style="margin-top: 0px;">template&lt;
    <span class="code-keyword">class</span> Container ,
    <span class="code-keyword">class</span> Time = <span class="code-keyword">double</span> ,
    <span class="code-keyword">class</span> Traits = container_traits&lt; Container &gt;
    &gt;
<span class="code-keyword">class</span> ode_step
{
    <span class="code-comment">//</span><span class="code-comment"> provide basic typedefs</span>
    <span class="code-comment">//</span><span class="code-comment"></span>
 <span class="code-keyword">public</span>:

    <span class="code-keyword">typedef</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">short</span> order_type;
    <span class="code-keyword">typedef</span> Time time_type;
    <span class="code-keyword">typedef</span> Traits traits_type;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> traits_type::container_type container_type;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> traits_type::value_type value_type;

    <span class="code-comment">//</span><span class="code-comment"> public interface</span>
 <span class="code-keyword">public</span>:

    <span class="code-comment">//</span><span class="code-comment"> return the order of the stepper</span>
    order_type order_step() <span class="code-keyword">const</span>;

    <span class="code-comment">//</span><span class="code-comment"> standard constructor</span>
    ode_step( <span class="code-keyword">void</span> );

    <span class="code-comment">//</span><span class="code-comment"> adjust the size of the internal arrays</span>
    <span class="code-keyword">void</span> adjust_size( <span class="code-keyword">const</span> container_type &amp;x );

    <span class="code-comment">//</span><span class="code-comment"> performs one step</span>
    template&lt; <span class="code-keyword">class</span> DynamicalSystem &gt;
    <span class="code-keyword">void</span> do_step( DynamicalSystem &amp;system ,
                  container_type &amp;x ,
                  <span class="code-keyword">const</span> container_type &amp;dxdt ,
                  time_type t ,
                  time_type dt );

    <span class="code-comment">//</span><span class="code-comment"> performs one step</span>
    template&lt; <span class="code-keyword">class</span> DynamicalSystem &gt;
    <span class="code-keyword">void</span> do_step( DynamicalSystem &amp;system ,
                  container_type &amp;x ,
                  time_type t ,
                  time_type dt );
};</pre>

<p>The container type defines how the state is stored. It has to fulfill some basic requirements like the value type and it should be default constructible. The <code>container_traits</code> type abstracts the resize functionality of the <a href="http://www.sgi.com/tech/stl/Sequence.html">sequence concept</a>. Furthermore, it knows how to obtain the appropriate <code>begin()</code> and <code>end()</code> iterators. Its usage will be shown below. The <code>adust_size</code> method is responsible for adjusting the size of any internal containers, which store the results of intermediate calculations.</p>

<p>The <code>do_step</code> functions calculates x(t+dt) from the knowledge of x(t), and they transform x(t) in-place, meaning that x(t) is replaced by x(t+dt) within <code>do_step</code>. The argument <code>system</code> defines the ODE. This can be a simple function with three arguments: <code>system( state , dxdt , t )</code>, or a class with the appropriate brackets <code>operator()(state,dxdt,t)</code>. Such a class is also known as a functor. Two versions of <code>do_step</code> exist: one which calculates x(t+dt) with the explicit knowledge of f(x(t)), and one which calculates this value internally. In principle, the second version only calls the first version. Both functions exist, because in many situations, the user needs the knowledge of f(x(t)) and will call the system method with x(t). To avoid a double call of <code>system</code>, the <code>do_step</code> version with the explicit declaration of f(x(t)) is introduced.</p>

<p>Note, that the above class definition is not found in the code; it is only used here to show the stepper functionality. All specific classes possessing these <code>typedef</code>s and methods are said to be stepper classes; we also say that all classes with these definitions fulfill the stepper concept.</p>

<p>Now, we look at a specific method, the Euler solver:</p>

<div class="pre-action-link" id="premain761361" style="width:100%;display:block;"><span id="prehide761361" onclick="processCodeBlocks.togglePre(761361);">Hide</span>  &nbsp; <span id="preShrink761361" onclick="processCodeBlocks.shrinkExpand(761361);">Shrink</span> <img id="preimg761361" src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(761361);">  &nbsp; <span id="copycode761361" onclick="return processCodeBlocks.copyCode(761361);">Copy Code</span></div><pre lang="C++" id="pre761361" processed="true" class="notranslate" style="margin-top: 0px;">template&lt;
    <span class="code-keyword">class</span> Container ,
    <span class="code-keyword">class</span> Time = <span class="code-keyword">double</span> ,
    <span class="code-keyword">class</span> Traits = container_traits&lt; Container &gt;
    &gt;
<span class="code-keyword">class</span> stepper_euler
{
    <span class="code-comment">//</span><span class="code-comment"> provide basic typedefs</span>
 <span class="code-keyword">public</span>:

    <span class="code-keyword">typedef</span> <span class="code-keyword">unsigned</span> <span class="code-keyword">short</span> order_type;
    <span class="code-keyword">typedef</span> Time time_type;
    <span class="code-keyword">typedef</span> Traits traits_type;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> traits_type::container_type container_type;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> traits_type::value_type value_type;

    <span class="code-comment">//</span><span class="code-comment"> private members</span>
 <span class="code-keyword">private</span>:

    container_type m_dxdt;

    <span class="code-comment">//</span><span class="code-comment"> public interface</span>
 <span class="code-keyword">public</span>:

    <span class="code-comment">//</span><span class="code-comment"> return the order of the stepper</span>
    order_type order_step() <span class="code-keyword">const</span> { <span class="code-keyword">return</span> <span class="code-digit">1</span>; }

    <span class="code-comment">//</span><span class="code-comment"> standard constructor, m_dxdt is not adjusted</span>
    stepper_euler( <span class="code-keyword">void</span> )
        {
        }

    <span class="code-comment">//</span><span class="code-comment"> contructor, which adjusts m_dxdt</span>
    stepper_euler( <span class="code-keyword">const</span> container_type &amp;x )
    {
        adjust_size( x );
    }

    <span class="code-comment">//</span><span class="code-comment"> adjust the size of m_dxdt</span>
    <span class="code-keyword">void</span> adjust_size( <span class="code-keyword">const</span> container_type &amp;x )
    {
        traits_type::adjust_size( x , m_dxdt );
    }

    <span class="code-comment">//</span><span class="code-comment"> performs one step with the knowledge of dxdt(t)</span>
    template&lt; <span class="code-keyword">class</span> DynamicalSystem &gt;
    <span class="code-keyword">void</span> do_step( DynamicalSystem &amp;system ,
                  container_type &amp;x ,
                  <span class="code-keyword">const</span> container_type &amp;dxdt ,
                  time_type t ,
                  time_type dt )
    {
        detail::it_algebra::increment( traits_type::begin(x) ,
                                       traits_type::end(x) ,
                                       traits_type::begin(dxdt) ,
                                       dt );
    }

    <span class="code-comment">//</span><span class="code-comment"> performs one step</span>
    template&lt; <span class="code-keyword">class</span> DynamicalSystem &gt;
    <span class="code-keyword">void</span> do_step( DynamicalSystem &amp;system ,
                  container_type &amp;x ,
                  time_type t ,
                  time_type dt )
    {
        system( x , m_dxdt , t );
        do_step( system , x , m_dxdt , t , dt );
    }
};</pre>

<p>This definition is straightforward, only some notes:</p>

<p>Adjusting the size is done in the <code>container_traits</code>-type. The standard traits type is defined as:</p>

<div class="pre-action-link" id="premain730011" style="width:100%;display:block;"><span id="prehide730011" onclick="processCodeBlocks.togglePre(730011);">Hide</span>  &nbsp; <span id="copycode730011" onclick="return processCodeBlocks.copyCode(730011);">Copy Code</span></div><pre lang="C++" id="pre730011" class="notranslate" style="margin-top: 0px;">template&lt; <span class="code-keyword">class</span> Container &gt;
<span class="code-keyword">struct</span> container_traits
{
    <span class="code-keyword">typedef</span> Container container_type;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> container_type::value_type value_type;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> container_type::iterator iterator;
    <span class="code-keyword">typedef</span> <span class="code-keyword">typename</span> container_type::const_iterator const_iterator;

    <span class="code-keyword">static</span> <span class="code-keyword">void</span> resize( <span class="code-keyword">const</span> container_type &amp;x , container_type &amp;dxdt ) 
	{ dxdt.resize( x.size() ); }
    <span class="code-keyword">static</span> <span class="code-keyword">bool</span> same_size( <span class="code-keyword">const</span> container_type &amp;x1 , <span class="code-keyword">const</span> container_type &amp;x2 ) 
	{ <span class="code-keyword">return</span> (x1.size() == x2.size()); }
    <span class="code-keyword">static</span> <span class="code-keyword">void</span> adjust_size( <span class="code-keyword">const</span> container_type &amp;x1 , container_type &amp;x2 ) 
	{ <span class="code-keyword">if</span>( !same_size( x1 , x2 ) ) resize( x1 , x2 ); }

    <span class="code-keyword">static</span> iterator begin( container_type &amp;x ) { <span class="code-keyword">return</span> x.begin(); }
    <span class="code-keyword">static</span> const_iterator begin( <span class="code-keyword">const</span> container_type &amp;x ) { <span class="code-keyword">return</span> x.begin(); }
    <span class="code-keyword">static</span> iterator end( container_type &amp;x ) { <span class="code-keyword">return</span> x.end(); }
    <span class="code-keyword">static</span> const_iterator end( <span class="code-keyword">const</span> container_type &amp;x ) { <span class="code-keyword">return</span> x.end(); }
};</pre>

<p>which will work with all (STL) containers, fulfilling the <a href="http://www.sgi.com/tech/stl/Sequence.html">sequence</a> and the <a href="http://www.sgi.com/tech/stl/Container.html">container</a> concept. But for other containers, these requirements are not sufficient. For example <code>std::tr1::array</code> does not possess a <code>resize</code> method. The container traits are also responsible to for the <code>begin()</code> and <code>end()</code> iterators. For <a href="http://www.sgi.com/tech/stl/Sequence.html">SGI containers</a> this is trivial, but for matrix types like Blitz++ or MTL matrices the <code>begin()</code> and <code>end()</code> are not defined, but can be obtained in different ways.</p>

<p>All iterator operations have been put in their own functions. This has the advantage that the code is small and clear, since no iterators need to be defined in the stepper functions. Furthermore, it is be possible to specialize and optimize these iterator functions for specific iterators or containers.</p>

<p>The adjust size functionality is necessary if the system size changes during the evolution; think, for example, of an ODE defined on a network with a non-constant number of nodes.</p>

<p>This is not the end of the story of the stepper functions. <strong>odeint</strong> also provides an advanced stepper concept which calculates the numerical errors made during each step. With this error calculation, it is possible to adapt the step-size dt during each step in the iteration. The concepts behind the adaptive step size integration will not be described in this article.</p>

<p>The following code demonstrates the usage of the stepper function:</p>

<div class="pre-action-link" id="premain298181" style="width:100%;display:block;"><span id="prehide298181" onclick="processCodeBlocks.togglePre(298181);">Hide</span>  &nbsp; <span id="preShrink298181" onclick="processCodeBlocks.shrinkExpand(298181);">Shrink</span> <img id="preimg298181" src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(298181);">  &nbsp; <span id="copycode298181" onclick="return processCodeBlocks.copyCode(298181);">Copy Code</span></div><pre lang="C++" id="pre298181" processed="true" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">iostream</span><span class="code-keyword">&gt;</span>
</span><span class="code-keyword">#include</span><span class="code-preprocessor"> <span class="code-keyword">&lt;</span><span class="code-leadattribute">boost/numeric/odeint.hpp</span><span class="code-keyword">&gt;</span>
</span>
<span class="code-preprocessor">#define tab "\t"
</span>
<span class="code-keyword">using</span> <span class="code-keyword">namespace</span> std;
<span class="code-keyword">using</span> <span class="code-keyword">namespace</span> boost::numeric::odeint;

<span class="code-keyword">typedef</span> vector&lt; <span class="code-keyword">double</span> &gt; state_type;

<span class="code-keyword">const</span> <span class="code-keyword">double</span> sigma = <span class="code-digit">10</span>.<span class="code-digit">0</span>;
<span class="code-keyword">const</span> <span class="code-keyword">double</span> R = <span class="code-digit">28</span>.<span class="code-digit">0</span>;
<span class="code-keyword">const</span> <span class="code-keyword">double</span> b = <span class="code-digit">8</span>.<span class="code-digit">0</span> / <span class="code-digit">3</span>.<span class="code-digit">0</span>;

<span class="code-keyword">void</span> lorenz( state_type &amp;x , state_type &amp;dxdt , <span class="code-keyword">double</span> t )
{
    dxdt[<span class="code-digit">0</span>] = sigma * ( x[<span class="code-digit">1</span>] - x[<span class="code-digit">0</span>] );
    dxdt[<span class="code-digit">1</span>] = R * x[<span class="code-digit">0</span>] - x[<span class="code-digit">1</span>] - x[<span class="code-digit">0</span>] * x[<span class="code-digit">2</span>];
    dxdt[<span class="code-digit">2</span>] = x[<span class="code-digit">0</span>]*x[<span class="code-digit">1</span>] - b * x[<span class="code-digit">2</span>];
}

<span class="code-keyword">int</span> main( <span class="code-keyword">int</span> argc , <span class="code-keyword">char</span> **argv )
{
    <span class="code-keyword">const</span> <span class="code-keyword">double</span> dt = <span class="code-digit">0</span>.<span class="code-digit">01</span>;

    state_type x(<span class="code-digit">3</span>);
    x[<span class="code-digit">0</span>] = <span class="code-digit">1</span>.<span class="code-digit">0</span> ;
    x[<span class="code-digit">1</span>] = <span class="code-digit">0</span>.<span class="code-digit">0</span> ;
    x[<span class="code-digit">2</span>] = <span class="code-digit">0</span>.<span class="code-digit">0</span>;
    stepper_euler&lt; state_type &gt; stepper;
    stepper.adjust_size( x );

    <span class="code-keyword">double</span> t = <span class="code-digit">0</span>.<span class="code-digit">0</span>;
    <span class="code-keyword">for</span>( <span class="code-sdkkeyword">size_t</span> oi=<span class="code-digit">0</span> ; oi&lt;10000 ; ++oi,t+=dt )
    {
        stepper.do_step( lorenz , x , t , dt );
        cout &lt;&lt; x[<span class="code-digit">0</span>] &lt;&lt; tab &lt;&lt; x[<span class="code-digit">1</span>] &lt;&lt; tab &lt;&lt; x[<span class="code-digit">2</span>] &lt;&lt; endl;
    }
}</pre>

<p>In some cases, it is desirable to define the ODE as a class. In our example, <code>lorenz</code> could also be defined as a class, having the appropriate bracket operator:</p>

<div class="pre-action-link" id="premain565261" style="width:100%;display:block;"><span id="prehide565261" onclick="processCodeBlocks.togglePre(565261);">Hide</span>  &nbsp; <span id="copycode565261" onclick="return processCodeBlocks.copyCode(565261);">Copy Code</span></div><pre lang="C++" id="pre565261" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">class</span> lorenz_class
{
 <span class="code-keyword">public</span>:
    <span class="code-keyword">void</span> <span class="code-keyword">operator</span>()( state_type &amp;x , state_type &amp;dxdt , <span class="code-keyword">double</span> t )
    {
        dxdt[<span class="code-digit">0</span>] = sigma * ( x[<span class="code-digit">1</span>] - x[<span class="code-digit">0</span>] );
        dxdt[<span class="code-digit">1</span>] = R * x[<span class="code-digit">0</span>] - x[<span class="code-digit">1</span>] - x[<span class="code-digit">0</span>] * x[<span class="code-digit">2</span>];
        dxdt[<span class="code-digit">2</span>] = x[<span class="code-digit">0</span>]*x[<span class="code-digit">1</span>] - b * x[<span class="code-digit">2</span>];
    }
}</pre>

<p>which is then called via:</p>

<div class="pre-action-link" id="premain492515" style="width:100%;display:block;"><span id="prehide492515" onclick="processCodeBlocks.togglePre(492515);">Hide</span>  &nbsp; <span id="copycode492515" onclick="return processCodeBlocks.copyCode(492515);">Copy Code</span></div><pre lang="C++" id="pre492515" class="notranslate" style="margin-top: 0px;">lorenz_class lorenzo;
stepper.do_step( lorenzo , x , t , dt );</pre>

<p>With classes more complicated dynamical systems (ODEs) can be created.</p>

<h3>Integration Function</h3>

<p>The next main idea is to provide one or more functions to automatically iterate the state of the ODE, with the possibility to observe the state in each step. This is done with the <code>integrate_const</code> function:</p>

<div class="pre-action-link" id="premain981138" style="width:100%;display:block;"><span id="prehide981138" onclick="processCodeBlocks.togglePre(981138);">Hide</span>  &nbsp; <span id="copycode981138" onclick="return processCodeBlocks.copyCode(981138);">Copy Code</span></div><pre lang="C++" id="pre981138" class="notranslate" style="margin-top: 0px;">template&lt;
    <span class="code-keyword">class</span> Stepper ,
    <span class="code-keyword">class</span> DynamicalSystem ,
    <span class="code-keyword">class</span> Observer
&gt;
<span class="code-sdkkeyword">size_t</span> integrate_const(
    Stepper &amp;stepper ,
    DynamicalSystem &amp;system ,
    <span class="code-keyword">typename</span> Stepper::container_type &amp;state ,
    <span class="code-keyword">typename</span> Stepper::time_type start_time ,
    <span class="code-keyword">typename</span> Stepper::time_type end_time ,
    <span class="code-keyword">typename</span> Stepper::time_type dt ,
    Observer &amp;observer
    )
{
    stepper.adjust_size( state );
    <span class="code-sdkkeyword">size_t</span> iteration = <span class="code-digit">0</span>;
    <span class="code-keyword">while</span>( start_time &lt; end_time )
    {
        observer( start_time , state , system );
        stepper.do_step( system , state , start_time , dt );
        start_time += dt;
        ++iteration;
    }
    observer( start_time , state , system );

    <span class="code-keyword">return</span> iteration;
}</pre>

<p>which solves the ODE with constant steps <code>dt</code> in the time interval <code>start_time</code>, <code>end_time</code>. The initial state has also to be provided. Furthermore, the concept of an observer is introduced, although this is not exactly an Observer pattern. Again, the observer can have any type, it only has to possesses the bracket operator, <code>operator()( time , state , system )</code>. For example, lambda expressions from <a href="http://www.boost.org/">boost</a> can be used:</p>

<div class="pre-action-link" id="premain952998" style="width:100%;display:block;"><span id="prehide952998" onclick="processCodeBlocks.togglePre(952998);">Hide</span>  &nbsp; <span id="copycode952998" onclick="return processCodeBlocks.copyCode(952998);">Copy Code</span></div><pre lang="C++" id="pre952998" class="notranslate" style="margin-top: 0px;">integrate_const( stepper , lorenz , x , <span class="code-digit">0</span>.<span class="code-digit">0</span> , <span class="code-digit">10</span>.<span class="code-digit">0</span> , dt ,
    cout &lt;&lt; _1 &lt;&lt; tab &lt;&lt; _2[<span class="code-digit">0</span>] &lt;&lt; <span class="code-string">"</span><span class="code-string">\n"</span> );</pre>

<p>or:</p>

<div class="pre-action-link" id="premain774729" style="width:100%;display:block;"><span id="prehide774729" onclick="processCodeBlocks.togglePre(774729);">Hide</span>  &nbsp; <span id="copycode774729" onclick="return processCodeBlocks.copyCode(774729);">Copy Code</span></div><pre lang="C++" id="pre774729" class="notranslate" style="margin-top: 0px;">vector&lt; <span class="code-keyword">double</span> &gt; lx;
back_insert_iterator&lt; vector&lt;double&gt; &gt; iter( lx );
integrate_const( stepper , lorenz , x , <span class="code-digit">0</span>.<span class="code-digit">0</span> , <span class="code-digit">10</span>.<span class="code-digit">0</span> , dt , var(*iter++) = _2[<span class="code-digit">0</span>] );</pre>

<h2>Installation</h2>

<p>The whole library is header only, meaning that no special installation process has to be carried out. On unixoid systems, do the following:</p>

<ol>
<li>Unpack the sources : <code>unzip odeint.zip</code> </li>

<li>Change to the odeint directory : <code>cd odeint</code> </li>

<li>Set the boost environment variable : <code>export $BOOST_ROOT=path_to_boost</code> </li>

<li>Compile the lorenz example : <code>make</code> </li>
</ol>

<p>Now, an executable <code>lorenz</code> should be present. The boost sources are needed for the lambda expressions in the example. You can download them from <a href="http://www.boost.org/">boost.org</a> and the environment variable should point to the root directory of boost, in which you will find the subdirectories <em>bin.v2</em>, <em>boost</em>, <em>doc</em>, <em>lib</em>, more, ...</p>

<p>For MSVC odeint will also work, but at the moment I don't have a step to step guide on how to compile the example.</p>

<h2>Summary and Outlook</h2>

<p>I have shown you some design aspects, and the usage of <strong>odeint</strong> - a C++ framework for solving ordinary differential equations. It is very easy to use and very flexible. The performance is also very good. We have made some test run, where <strong>odeint</strong> is compared with the <a href="http://www.gnu.org/software/gsl/">gsl</a>. As a test system, the Lorenz system was used. It turned out that <strong>odeint</strong> is about two times faster than the gsl routines.</p>

<p>The source code provided with this article is a snapshot of the current development. Some methods for adaptive step size control exist and some methods to solve Hamiltonian system. In the following table, an overview over existing methods is given. S means that the stepper fulfills the simple stepper concept described above, whereas E means that the stepper fulfills the Error stepper concept, which is not introduced here but needed for adaptive step size control.</p>

















































































































<table width="640" class="ArticleTable"><thead><tr><td><strong>Method</strong></td><td><strong>Class name</strong></td><td><strong>Order</strong></td><td><strong>Error (order)</strong></td><td><strong>Stepper concept</strong></td></tr></thead><tbody><tr><td>Euler</td><td><code>stepper_euler</code></td><td>1</td><td>No</td><td>S</td></tr><tr><td>Runge Kutta 4</td><td><code>stepper_rk4</code></td><td>4</td><td>No</td><td>S</td></tr><tr><td>Runge Kutta Cash Karp</td><td><code>stepper_rk5_ck</code></td><td>5</td><td>Yes 4</td><td>E</td></tr><tr><td>Runge Kutta Fehlber</td><td><code>stepper_rk78_fehlberg</code></td><td>7</td><td>Yes 8</td><td>S,E</td></tr><tr><td>Midpoint</td><td><code>stepper_midpoint</code></td><td>Var.</td><td>No</td><td>S</td></tr><tr><td height="10"></td><td></td><td></td><td></td><td></td></tr><tr><td>Symplectic Euler</td><td><code>hamiltonian_stepper_euler</code></td><td>1</td><td>No</td><td>S</td></tr><tr><td>Symplectic Runge-Kutta</td><td><code>hamiltonian_stepper_rk</code></td><td>6</td><td>No</td><td>S</td></tr></tbody></table>

<p>The whole library is not complete, and will be extended in the near future. We have a small Todo list, which should be completed before the final release:</p>

<ul>
<li>Adaptors for Blitz++, MTL, <code>boost::ublas </code>and <code>boost::multi_array</code> </li>

<li>Documentation </li>

<li>Solvers for stiff systems </li>

<li>Abstract the iterator algebra </li>
</ul>

<p>If you like to contribute to this library, or have some interesting points, criticisms, or suggestions, you are cordially invited.</p>

<h2>History</h2>

<ul>
<li>9.11.2009 - Initial document </li>

<li>16.3.2010 - Update, introducing the container traits, replacing the examples </li>

<li>23.3.2010 - Updated source code and article </li>
</ul>


						</div>
						

						<div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc">
						<div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Math" data-loadonview="true" data-tags="C++, Windows, STL, Architect, Dev, Linux, Intermediate, Advanced,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=300x250&amp;c=559694"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=300x250&amp;c=559694"  width="300px" height="250px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
						</div>
                        
                        
						
						<h2>License</h2>
						<div id="LicenseTerms"><p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p></div>
						

                        
						<h2>Share</h2>
				        <div class="share-list">
					        



<!-- Buttons start here. Copy this ul to your document. -->
<ul class="rrssb-buttons clearfix rrssb-1">
    <li class="email" data-initwidth="16.666666666666668" data-size="34" style="width: calc(100% - 210px);">

        <a href="mailto:?subject=Solving%20ordinary%20differential%20equations%20in%20C%2b%2b%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C%0a">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                        <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                            c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                            9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                            0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                            7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                            0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                            26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                            1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z"></path></g>
                </svg>
            </span>
            <span class="text">email</span>
        </a>
    </li>
    <li class="twitter small" data-initwidth="16.666666666666668" data-size="49" style="width: 42px;">
        <!-- Replace href with your Meta and URL information  -->
        <a href="http://twitter.com/home?status=Solving+ordinary+differential+equations+in+C%2b%2b+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                    c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                    C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                    C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                    c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                    C26.275,7.229,25.39,8.196,24.253,8.756z"></path>
                </svg>
            </span>
            <span class="text">twitter</span>
        </a>
    </li>

    <li class="facebook small" data-initwidth="16.666666666666668" data-size="62" style="width: 42px;">
        <!-- Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: 
        https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ -->
        <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                        c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                        c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z"></path>
                </svg>
            </span>
            <span class="text">facebook</span>
        </a>
    </li>
    
    <li class="linkedin small" data-initwidth="16.666666666666668" data-size="52" style="width: 42px;">
        <!-- Replace href with your meta and URL information -->
        <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C&amp;title=Solving+ordinary+differential+equations+in+C%2b%2b+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                        c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                        h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                        c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                        C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z"></path>
                </svg>
            </span>
            <span class="text">linkedin</span>
        </a>
    </li>
    <li class="reddit small" data-initwidth="16.666666666666668" data-size="41" style="width: 42px;">
        <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C&amp;title=Solving+ordinary+differential+equations+in+C%2b%2b+-+CodeProject">
            <span class="icon">
                <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"><g>
                <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z"></path>
                <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z"></path>
                <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                19.5 17.8 19.5 17.5 19.791z"></path><path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                C26.354 13.8 26.1 14.3 25.8 14.605z"></path></g></svg>
            </span>
            <span class="text">reddit</span>
        </a>
    </li>
    <li class="googleplus small" data-initwidth="16.666666666666668" data-size="55" style="width: 42px;">
        <!-- Replace href with your meta and URL information.  -->
        <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.codeproject.com%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C" class="popup">
            <span class="icon">
                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewBox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                    <g>
                        <g>
                            <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663
                                c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027
                                C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068
                                c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562
                                c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41
                                c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511
                                c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478
                                c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492
                                c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479
                                c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z"></path>
                            <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004
                                23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89      "></polygon>
                        </g>
                    </g>
                </svg>
            </span>
            <span class="text">google+</span>
        </a>
    </li>
    
</ul>
<!-- Buttons end here -->

				        </div> 
    			        


						
						<h2 id="ctl00_AboutHeading">About the Author</h2>
						    


<div class="author-wrapper">

    <div class="pic-wrapper"> 
        <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="./Solving ordinary differential equations in C++ - CodeProject_files/member_unknown.gif" style="border-width:0px;transform:rotate(-1deg);">

    </div>

    <div class="container-member">  
        <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="https://www.codeproject.com/Members/headmyshoulder">headmyshoulder</a></b>

        <table class="extended">
        <tbody><tr>
            <td rowspan="2" nowrap="" valign="middle">
            
            </td>
            <td width="100%">
                <div class="company">
                    <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle"></span>
	                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany"></span>
                </div>
            </td>
        </tr>
        <tr>
            <td>
                <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Germany <img src="./Solving ordinary differential equations in C++ - CodeProject_files/DE.gif" alt="Germany" width="16px" height="11px"></span>
            </td>
        </tr>
        </tbody></table>
    </div>

    <div class="description">
        No Biography provided

        
    </div>

</div><br>
						
						

						<div class="clearfix"></div>

						<div style="padding-top:8px">
							
						</div>

					

				    
					</form>

				</div>

				
				<div class="bottom-promo"> 
				    <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Math" data-loadonview="true" data-tags="C++, Windows, STL, Architect, Dev, Linux, Intermediate, Advanced,rating4.5,pos_bottom"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=728x90&amp;c=559694"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=728x90&amp;c=559694"  width="728px" height="90px" target="_blank"/&gt;&lt;/a&gt;</noscript></div>
				</div>
				

                
        <h2 id="ctl00_AlsoRead_RelatedResults_ctl00_Header" class="also-read">You may also be interested in...</h2>
        <table class="spaced content-list also-read">
    
	    <tbody><tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl01_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl01_Thumbnail" href="https://www.codeproject.com/Articles/268589/odeint-v-Solving-ordinary-differential-equations"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/Thumb-268589.png" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl01_Link" href="https://www.codeproject.com/Articles/268589/odeint-v-Solving-ordinary-differential-equations">odeint v2 - Solving ordinary differential equations in C++</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl02_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl02_Thumbnail" href="https://www.codeproject.com/Articles/47864/Generate-and-add-keyword-variations-using-AdWords"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/Thumb-47864.png" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl02_Link" href="https://www.codeproject.com/Articles/47864/Generate-and-add-keyword-variations-using-AdWords">Generate and add keyword variations using AdWords API</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl03_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl03_Thumbnail" href="https://www.codeproject.com/Articles/18922/Solving-a-differential-equation"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/Thumb-18922.gif" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl03_Link" href="https://www.codeproject.com/Articles/18922/Solving-a-differential-equation">Solving a differential equation</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl04_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl04_Thumbnail" href="https://www.codeproject.com/Articles/107/Window-Tabs-WndTabs-Add-In-for-DevStudio"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/Thumb-107.jpg" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl04_Link" href="https://www.codeproject.com/Articles/107/Window-Tabs-WndTabs-Add-In-for-DevStudio">Window Tabs (WndTabs) Add-In for DevStudio</a></div>
                
            </div>
        </td>
	    </tr>
	
	    <tr>
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl05_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl05_Thumbnail" href="https://www.codeproject.com/Articles/23/SAPrefs-Netscape-like-Preferences-Dialog"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/Thumb-23.gif" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl05_Link" href="https://www.codeproject.com/Articles/23/SAPrefs-Netscape-like-Preferences-Dialog">SAPrefs - Netscape-like Preferences Dialog</a></div>
                
            </div>
        </td>
	
        <td class="content-list-item" width="50%" valign="top">
            <div id="ctl00_AlsoRead_RelatedResults_ctl06_ThumbnailContainer" class="thumbnail">
                <a id="ctl00_AlsoRead_RelatedResults_ctl06_Thumbnail" href="https://www.codeproject.com/Articles/1449/OLE-DB-First-steps"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/article100x80.png" alt="" style="border-width:0px;"></a>
            </div>
            <div class="text">
                <div class="title"><a id="ctl00_AlsoRead_RelatedResults_ctl06_Link" href="https://www.codeproject.com/Articles/1449/OLE-DB-First-steps">OLE DB - First steps</a></div>
                
            </div>
        </td>
	    </tr>
	
		</tbody></table>
	



				
				

					<h2>Comments and Discussions</h2>
					<a class="float-left" name="_comments" id="_comments">&nbsp;</a><div id="_MessageBoardctl00_MessageBoard" onclick="return forumControl945387.SwitchMessage(event, null)">
<table id="ForumTable" class="forum relaxed" cellpadding="0" cellspacing="0">
<tbody><tr>
<td class="header1 callout"><b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C%3ffid%3d1551608%26df%3d90%26mpp%3d25%26prof%3dTrue%26sort%3dPosition%26view%3dExpanded%26spc%3dRelaxed">Sign In</a> to use this message board.</b></td>
</tr><tr>
<td><table width="100%" border="0" cellpadding="3px" cellspacing="0">
<tbody><tr class="header1">
<td colspan="2" style="white-space:nowrap;"><div class="container">
<div class="float-right">
<form action="https://www.codeproject.com/Search.aspx?sbo=fm" method="get" class="searchbar">
<input type="hidden" name="fid" value="1551608"><input type="hidden" name="sbo" value="fm"><b>Search Comments </b><input type="search" class="search" name="qf">&nbsp;<input type="submit" value="Go" class="button">
</form>
</div>
</div></td>
</tr><tr class="header2">
<td></td><td style="width:100%;"><div style="text-align:right;">
<form action="https://www.codeproject.com/script/Forums/SetOptions.aspx?fid=1551608&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Expanded&amp;spc=Relaxed&amp;floc=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C" method="get" style="margin:0;padding:0;">
<input type="hidden" name="fid" value="1551608"><input type="hidden" name="currentQS" value="fid=1551608&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Expanded&amp;spc=Relaxed&amp;floc=%2fArticles%2f43607%2fSolving-ordinary-differential-equations-in-C"><input type="hidden" name="floc" value="/Articles/43607/Solving-ordinary-differential-equations-in-C">Spacing<select size="1" class="dropdown" name="spc">
<option selected="" value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option value="Tight">Tight</option>
</select>&nbsp;&nbsp;Layout<select size="1" class="dropdown" name="view">
<option value="Normal">Normal</option><option value="Topic">Open Topics</option><option selected="" value="Expanded">Open All</option><option value="Thread">Thread View</option>
</select>&nbsp;&nbsp;Per page<select size="1" class="dropdown" name="mpp">
<option value="10">10</option><option selected="" value="25">25</option><option value="50">50</option>
</select>&nbsp;&nbsp;&nbsp;<input type="submit" value="Update" name="SetOpt" class="button">
</form>
</div></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><a name="xx0xx"></a><table border="0" cellpadding="2px" cellspacing="0" width="100%">
<tbody><tr class="navbar">
<td></td><td style="text-align:right;width:50%;"></td><td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;prof=True&amp;sort=Position&amp;view=Expanded&amp;spc=Relaxed&amp;fr=26#xx0xx">Next</a></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background">
<tbody><tr>
<td><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" border="0" width="1px" height="5px" alt=""></td>
</tr><tr id="F5180356_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx5180356xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">solve state-space model?<div class="mobile-only">
	<span class="author">Mohammed Alloboany</span><span class="date">30-Dec-15  0:47</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=11918562">Mohammed Alloboany</a></span></td><td class="date"><span>30-Dec-15  0:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="11918562" msgid="5180356" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi<br>
I want to simulate car suspension system and draw a car moving by OpenGl but I find some problems in how to solve state-space suspension equation , is thos library help me??<br>
some links to explain:<br>
<a href="http://ctms.engin.umich.edu/CTMS/index.php?example=Suspension&amp;section=SystemModeling"><br>
<br>
</a>[<a href="http://ctms.engin.umich.edu/CTMS/index.php?example=Suspension&amp;section=SystemModeling" target="_blank" title="New Window">^First</a>]<br>
<br>
<a href="http://ctms.engin.umich.edu/CTMS/index.php?example=Suspension&amp;section=ControlStateSpace"><br>
</a>[<a href="http://ctms.engin.umich.edu/CTMS/index.php?example=Suspension&amp;section=ControlStateSpace" target="_blank" title="New Window">^Second</a>]<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5180356" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/5180356/solve-state-space-model.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF5180356" data-ref="3_5180356" class="rating-label" name="RateItem_5180356" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F5211889_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx5211889xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="5211889" parent="5180356" thread="5180356" href="https://www.codeproject.com/Messages/5211889/Re-solve-state-space-model.aspx">Re: solve state-space model?</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">7-Mar-16  20:57</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>7-Mar-16  20:57&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1619496" msgid="5211889" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,5180356);" href="https://www.codeproject.com/Messages/5180356/solve-state-space-model.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Yes, I think this library will help you. It will solve the state space suspension equation.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=5180356" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/5211889/Re-solve-state-space-model.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF5211889" data-ref="3_5211889" class="rating-label" name="RateItem_5211889" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4335904_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4335904xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container">My vote of 5<div class="mobile-only">
	<span class="author">Edward Keningham</span><span class="date">11-Aug-12  3:22</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=9347566">Edward Keningham</a></span></td><td class="date"><span>11-Aug-12  3:22&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="9347566" msgid="4335904" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank you, this will definitely be useful somehow<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4335904" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4335904/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4335904" data-ref="3_4335904" class="rating-label" name="RateItem_4335904" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4164319_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4164319xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container">My vote of 1<div class="mobile-only">
	<span class="author">RedDK</span><span class="date">22-Feb-12  6:30</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=660010">RedDK</a></span></td><td class="date"><span>22-Feb-12  6:30&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="660010" msgid="4164319" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">still think the same thing I thought in October and nothing's changed<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4164319" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4164319/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4164319" data-ref="3_4164319" class="rating-label" name="RateItem_4164319" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4335113_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4335113xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4335113" parent="4164319" thread="4164319" href="https://www.codeproject.com/Messages/4335113/Re-My-vote-of.aspx">Re: My vote of 1</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">10-Aug-12  1:48</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>10-Aug-12  1:48&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1619496" msgid="4335113" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4164319);" href="https://www.codeproject.com/Messages/4164319/My-vote-of.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>look here: <a href="http://www.codeproject.com/Articles/268589/odeint-v2-Solving-ordinary-differential-equations">odeint v2 - Solving ordinary differential equations in C++</a>[<a href="http://www.codeproject.com/Articles/268589/odeint-v2-Solving-ordinary-differential-equations" target="_blank" title="New Window">^</a>]. But is also boost and Linux^^. Seriously, there are no problems with windows.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4164319" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4335113/Re-My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4335113" data-ref="3_4335113" class="rating-label" name="RateItem_4335113" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4154332_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4154332xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container">Excellent stuff<div class="mobile-only">
	<span class="author">Espen Harlinn</span><span class="date">11-Feb-12  5:07</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-MVP-16.gif" title="mvp" alt="mvp" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=22364">Espen Harlinn</a></span></td><td class="date"><span>11-Feb-12  5:07&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="22364" msgid="4154332" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Excellent stuff - well worth a 5+<br>
<div class="signature"><a href="http://harlinn.com/">Espen Harlinn</a><br>
Senior Architect, Software - Goodtech Projects &amp; Services<br>
<a href="http://www.google.com/url?sa=t&amp;rct=j&amp;q=%22espen%20harlinn%22&amp;source=web&amp;cd=3&amp;ved=0CC0QFjAC&amp;url=http%3A%2F%2Fno.linkedin.com%2Fpub%2Fespen-harlinn%2F28%2F94%2Fa17&amp;ei=VoggT6H3HqmN4gSa4MGwCA&amp;usg=AFQjCNENESIQ_g9rtInernhzxqbBiIUduw">My LinkedIn Profile</a></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4154332" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4154332/Excellent-stuff.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4154332" data-ref="3_4154332" class="rating-label" name="RateItem_4154332" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4136229_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4136229xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">speed question<div class="mobile-only">
	<span class="author">Antediluvian9999</span><span class="date">23-Jan-12  5:27</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8559267">Antediluvian9999</a></span></td><td class="date"><span>23-Jan-12  5:27&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8559267" msgid="4136229" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Hi I'm running some code and I'm trying to use this library to get the code to run quicker. Basically the problem is, when I use my own RK4 (no error estimation, adaptive step size etc, just the basic thing), the code runs much quicker than if I implement the following:<br>
<br>
<div class="pre-action-link" id="premain228006" style="width:100%;display:block;"><span id="prehide228006" onclick="processCodeBlocks.togglePre(228006);">Hide</span>  &nbsp; <span id="copycode228006" onclick="return processCodeBlocks.copyCode(228006);">Copy Code</span></div><pre lang="c++" id="pre228006" class="notranslate" style="margin-top: 0px;"><span class="code-comment">/*</span><span class="code-comment">*** do stuff up here ****/</span>
runge_kutta4&lt; state_type &gt; stepper;
<span class="code-keyword">while</span>(SRparameters[<span class="code-digit">0</span>] &lt; <span class="code-digit">1</span>) {
   <span class="code-comment">/*</span><span class="code-comment">...*/</span>
   <span class="code-comment">//</span><span class="code-comment">RK4(SRparameters, dN);			</span>
   stepper.do_step(ODE, SRparameters, N, dN);
   <span class="code-comment">/*</span><span class="code-comment">...*/</span>
}
<span class="code-comment">/*</span><span class="code-comment">*** do more stuff ****/</span></pre><br>
<br>
<div class="pre-action-link" id="premain738004" style="width:100%;display:block;"><span id="prehide738004" onclick="processCodeBlocks.togglePre(738004);">Hide</span>  &nbsp; <span id="copycode738004" onclick="return processCodeBlocks.copyCode(738004);">Copy Code</span></div><pre id="pre738004" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">void</span> ODE(<span class="code-keyword">const</span> state_type &amp;x, state_type &amp;dxdN, <span class="code-keyword">const</span> <span class="code-keyword">double</span> N){
&nbsp;
    dxdN[0] = F(x[0], x[1]);        
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> l = <span class="code-digit">1</span>; l <span class="code-keyword">&lt;</span> L; l++)dxdN[l] = G(x[0], x[1], x[l], x[l+1], l);
    dxdN[L] = G(x[0], x[1], x[L], <span class="code-digit">0</span>, L);
}</pre><br>
<br>
The difference is by a factor of 2 or 3 although its hard to say as I have suppressed a lot of what goes on. I'm not too sure but could the difference caused by the program calling from many different library's?<br>
<br>
I was hoping to implement one of the more sophisticated methods but I might be doing something wrong to hinder the program. I'm compiling under Visual Studio 2010 if that makes any difference.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4136229/speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4136229" data-ref="3_4136229" class="rating-label" name="RateItem_4136229" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4136232_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4136232xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="4136232" parent="4136229" thread="4136229" href="https://www.codeproject.com/Messages/4136232/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">Antediluvian9999</span><span class="date">23-Jan-12  5:28</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8559267">Antediluvian9999</a></span></td><td class="date"><span>23-Jan-12  5:28&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="8559267" msgid="4136232" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4136229);" href="https://www.codeproject.com/Messages/4136229/speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Sorry just realised I posted in the old version <img src="./Solving ordinary differential equations in C++ - CodeProject_files/smiley_frown.gif" align="top" alt="Frown | :("><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4136232/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4136232" data-ref="3_4136232" class="rating-label" name="RateItem_4136232" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4136240_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4136240xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="4136240" parent="4136229" thread="4136229" href="https://www.codeproject.com/Messages/4136240/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">23-Jan-12  5:40</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>23-Jan-12  5:40&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1619496" msgid="4136240" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4136229);" href="https://www.codeproject.com/Messages/4136229/speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi, its difficult to say whats going on. Can you post your rk4 method? Stupid question: Do you build the code in release mode?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4136240/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4136240" data-ref="3_4136240" class="rating-label" name="RateItem_4136240" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4136247_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx4136247xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4136247" parent="4136240" thread="4136229" href="https://www.codeproject.com/Messages/4136247/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">Antediluvian9999</span><span class="date">23-Jan-12  5:47</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8559267">Antediluvian9999</a></span></td><td class="date"><span>23-Jan-12  5:47&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="8559267" msgid="4136247" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="56px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4136240);" href="https://www.codeproject.com/Messages/4136240/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi there thankyou for the quick reply.<br>
<br>
<div class="pre-action-link" id="premain611983" style="width:100%;display:block;"><span id="prehide611983" onclick="processCodeBlocks.togglePre(611983);">Hide</span>  &nbsp; <span id="preShrink611983" onclick="processCodeBlocks.shrinkExpand(611983);">Expand</span> <img id="preimg611983" src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-down-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(611983);">  &nbsp; <span id="copycode611983" onclick="return processCodeBlocks.copyCode(611983);">Copy Code</span></div><pre lang="c++" id="pre611983" shrunk="true" processed="true" class="notranslate" style="margin-top: 0px; overflow: auto; height: 400px;"><span class="code-comment">//</span><span class="code-comment">RK4 integration function</span>
<span class="code-keyword">void</span> RK4(vector&lt;double&gt; &amp;SR, <span class="code-keyword">double</span> dt){
&nbsp;
    K1[<span class="code-digit">0</span>] = F(SR[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>])*dt;                             
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> l = <span class="code-digit">1</span>; l &lt; L; l++){
        K1[l] = G(SR[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>], SR[l], SR[l+1],l)*dt;
    }
    K1[L] = G(SR[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>], SR[L], <span class="code-digit">0</span>.<span class="code-digit">0</span>, L)*dt;          
&nbsp;
    K2[<span class="code-digit">0</span>] = F(SR[<span class="code-digit">0</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[<span class="code-digit">1</span>])*dt;
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> l = <span class="code-digit">1</span>; l &lt; L; l++){
        K2[l] = G(SR[<span class="code-digit">0</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[<span class="code-digit">1</span>], SR[l] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[l], SR[l+1] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[l+1],l)*dt;
    }
    K2[L] = G(SR[<span class="code-digit">0</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[<span class="code-digit">1</span>], SR[L] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K1[L], <span class="code-digit">0</span>.<span class="code-digit">0</span>,L)*dt;
&nbsp;
    K3[<span class="code-digit">0</span>] = F(SR[<span class="code-digit">0</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[<span class="code-digit">1</span>])*dt;
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> l = <span class="code-digit">1</span>; l &lt; L; l++){
        K3[l] = G(SR[<span class="code-digit">0</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[<span class="code-digit">1</span>], SR[l] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[l], SR[l+1] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[l+1],l)*dt;
    }
    K3[L] = G(SR[<span class="code-digit">0</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[<span class="code-digit">1</span>], SR[L] + <span class="code-digit">0</span>.<span class="code-digit">5</span>*K2[L], <span class="code-digit">0</span>.<span class="code-digit">0</span>,L)*dt;
&nbsp;
    K4[<span class="code-digit">0</span>] = F(SR[<span class="code-digit">0</span>] + K3[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + K3[<span class="code-digit">1</span>])*dt;
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> l = <span class="code-digit">1</span>; l &lt; L; l++){
        K4[l] = G(SR[<span class="code-digit">0</span>] + K3[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + K3[<span class="code-digit">1</span>], SR[l] + K3[l], SR[l+1] + K3[l+1],l)*dt;
    }
    K4[L] = G(SR[<span class="code-digit">0</span>] + K3[<span class="code-digit">0</span>], SR[<span class="code-digit">1</span>] + K3[<span class="code-digit">1</span>], SR[L] + K3[L], <span class="code-digit">0</span>.<span class="code-digit">0</span>,L)*dt;
&nbsp;
    <span class="code-comment">//</span><span class="code-comment">updates slow roll parameters</span>
    <span class="code-keyword">for</span>(<span class="code-keyword">int</span> l = <span class="code-digit">0</span>; l &lt; L+1; l++){
        SR[l] = SR[l] + (<span class="code-digit">1</span>.<span class="code-digit">0</span>)/(<span class="code-digit">6</span>.<span class="code-digit">0</span>)*(K1[l] + <span class="code-digit">2</span>*K2[l] + <span class="code-digit">2</span>*K3[l] + K4[l]);
    }
&nbsp;
}</pre><br>
<br>
So far I've been running it in debug mode.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4136247/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4136247" data-ref="3_4136247" class="rating-label" name="RateItem_4136247" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4136268_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx4136268xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4136268" parent="4136247" thread="4136229" href="https://www.codeproject.com/Messages/4136268/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">Antediluvian9999</span><span class="date">23-Jan-12  6:02</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8559267">Antediluvian9999</a></span></td><td class="date"><span>23-Jan-12  6:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="8559267" msgid="4136268" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="74px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4136247);" href="https://www.codeproject.com/Messages/4136247/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Ok I changed it to release mode and now it runs about 200x faster than my RK4. Thanks for the tip!<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4136268/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4136268" data-ref="3_4136268" class="rating-label" name="RateItem_4136268" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4136348_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="92px" class="indent"><a name="xx4136348xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4136348" parent="4136268" thread="4136229" href="https://www.codeproject.com/Messages/4136348/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">23-Jan-12  8:10</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>23-Jan-12  8:10&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="1619496" msgid="4136348" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="92px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4136268);" href="https://www.codeproject.com/Messages/4136268/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Ok, thats fine. I think your code should also be faster when compiled in release mode.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4136348/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4136348" data-ref="3_4136348" class="rating-label" name="RateItem_4136348" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4158377_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="110px" class="indent"><a name="xx4158377xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4158377" parent="4136348" thread="4136229" href="https://www.codeproject.com/Messages/4158377/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">Antediluvian9999</span><span class="date">15-Feb-12  14:58</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8559267">Antediluvian9999</a></span></td><td class="date"><span>15-Feb-12  14:58&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:110px;"><span class="voteform vertical" ownerid="8559267" msgid="4158377" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="110px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4136348);" href="https://www.codeproject.com/Messages/4136348/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi sorry to bother you again but I'm having some problems when trying to get the code to integrate backwards in time and redefining time isn't really an option.<br>
<br>
Basically I'm calling <br>
<br>
<div class="pre-action-link" id="premain520336" style="width:100%;display:block;"><span id="prehide520336" onclick="processCodeBlocks.togglePre(520336);">Hide</span>  &nbsp; <span id="copycode520336" onclick="return processCodeBlocks.copyCode(520336);">Copy Code</span></div><pre lang="c++" id="pre520336" class="notranslate" style="margin-top: 0px;">integrate_adaptive(controlled_stepper, ODEpot, Observables, NvaluesSR[i], NvaluesSR[i-<span class="code-digit">1</span>], dN, push_back_state_and_time(ObservableValues, NvaluesObs));</pre><br>
<br>
where NvaluesSR[i] &gt; NvaluesSR[i-1] and dN = -0.01. NvaluesSR are the time values push_back_state_and_time gave out earlier in the code when integrating (some different ODE's) forward in time.<br>
<br>
Anyway at first the code wasn't doing anything, updating N or calling ODEpot. So I had a look in integrate_adaptive.hpp and figured the problem was caused by the loop (line 87)<br>
<br>
<div class="pre-action-link" id="premain19094" style="width:100%;display:block;"><span id="prehide19094" onclick="processCodeBlocks.togglePre(19094);">Hide</span>  &nbsp; <span id="copycode19094" onclick="return processCodeBlocks.copyCode(19094);">Copy Code</span></div><pre lang="c++" id="pre19094" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">while</span>(start_time &lt; end_time)
{
...
<span class="code-keyword">if</span>( ( start_time + dt ) &gt; end_time ){...}
...
}</pre><br>
<br>
which obviously wasn't running in my code as start_time &gt; end_time. So to try and get it to work I just copied/pasted the same loop straight after but with &lt; and &gt; swapped. Anyway the problem seems to be that when a negative dt is passed through m_max_rel_error (controlled_runge_kutta.hpp*, line 238) becomes infinite and either the program grinds to a halt as it reduces dt to ridiculously tiny values or it crashes. I tried figuring out how to fix it but I ran into a deadend. Is this an easy fix? Any help would be greatly appreciated.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4158377/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4158377" data-ref="3_4158377" class="rating-label" name="RateItem_4158377" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4159815_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="120px" class="indent"><a name="xx4159815xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4159815" parent="4158377" thread="4136229" href="https://www.codeproject.com/Messages/4159815/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">16-Feb-12  23:13</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>16-Feb-12  23:13&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:120px;"><span class="voteform vertical" ownerid="1619496" msgid="4159815" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="120px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4158377);" href="https://www.codeproject.com/Messages/4158377/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi, at the moment odeint is not able to work with negative time steps. But, if your system is autonomous, hence it does not explicitly depend on t, you can simply multiply the derivative with -1 within the evaluation of your ODE and it will integrate backward in time. Hope this helps.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4159815/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4159815" data-ref="3_4159815" class="rating-label" name="RateItem_4159815" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4159846_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="130px" class="indent"><a name="xx4159846xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4159846" parent="4159815" thread="4136229" href="https://www.codeproject.com/Messages/4159846/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">Antediluvian9999</span><span class="date">16-Feb-12  23:46</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=8559267">Antediluvian9999</a></span></td><td class="date"><span>16-Feb-12  23:46&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:130px;"><span class="voteform vertical" ownerid="8559267" msgid="4159846" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="130px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4159815);" href="https://www.codeproject.com/Messages/4159815/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Hi there, unfortunately the system does depend on t and the t dependence comes from integrating a function earlier in the code. So I only have the t dependance at discrete points (interpolating between them). I did try that before but, naturally it didn't work. Is there anything else I can?<br>
Thankyou for the reply.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4159846/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4159846" data-ref="3_4159846" class="rating-label" name="RateItem_4159846" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4160980_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="140px" class="indent"><a name="xx4160980xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4160980" parent="4159846" thread="4136229" href="https://www.codeproject.com/Messages/4160980/Re-speed-question.aspx">Re: speed question</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">18-Feb-12  11:34</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>18-Feb-12  11:34&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:140px;"><span class="voteform vertical" ownerid="1619496" msgid="4160980" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="140px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4159846);" href="https://www.codeproject.com/Messages/4159846/Re-speed-question.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>You can also introduce the time as a dependent variable with the trivial dynamic dt/dt = 1, or for the backward integration dt/dt = -1. This enlarges your system by one dimension, and you also might loose a bit of performance but this should be not so much. For example, the time-dependent harmonic oscillator changes from<br>
<div class="pre-action-link" id="premain824419" style="width:100%;display:block;"><span id="prehide824419" onclick="processCodeBlocks.togglePre(824419);">Hide</span>  &nbsp; <span id="copycode824419" onclick="return processCodeBlocks.copyCode(824419);">Copy Code</span></div><pre lang="c++" id="pre824419" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">typedef</span> array&lt; <span class="code-keyword">double</span> , <span class="code-digit">2</span> &gt; state_type;
<span class="code-keyword">void</span> harm_osc( <span class="code-keyword">const</span> state_type &amp;x , state_type &amp;dxdt , <span class="code-keyword">double</span> t )
{
    dxdt[<span class="code-digit">0</span>] = x[<span class="code-digit">1</span>];
    dxdt[<span class="code-digit">1</span>] = - x[<span class="code-digit">0</span>] + cos( omega * t );
}</pre><br>
to<br>
<div class="pre-action-link" id="premain679762" style="width:100%;display:block;"><span id="prehide679762" onclick="processCodeBlocks.togglePre(679762);">Hide</span>  &nbsp; <span id="copycode679762" onclick="return processCodeBlocks.copyCode(679762);">Copy Code</span></div><pre lang="c++" id="pre679762" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">typedef</span> array&lt; <span class="code-keyword">double</span> , <span class="code-digit">3</span> &gt; state_type;
<span class="code-keyword">void</span> harm_osc( <span class="code-keyword">const</span> state_type &amp;x , state_type &amp;dxdt , <span class="code-keyword">double</span> t )
{
    dxdt[<span class="code-digit">0</span>] = x[<span class="code-digit">1</span>];
    dxdt[<span class="code-digit">1</span>] = - x[<span class="code-digit">0</span>] + cos( omega * x[<span class="code-digit">2</span>] );
    dxdt[<span class="code-digit">2</span>] = <span class="code-digit">1</span>.<span class="code-digit">0</span>;
}</pre><br>
You can also introduce the direction by one flag:<br>
<div class="pre-action-link" id="premain28845" style="width:100%;display:block;"><span id="prehide28845" onclick="processCodeBlocks.togglePre(28845);">Hide</span>  &nbsp; <span id="copycode28845" onclick="return processCodeBlocks.copyCode(28845);">Copy Code</span></div><pre lang="c++" id="pre28845" class="notranslate" style="margin-top: 0px;"><span class="code-keyword">typedef</span> array&lt; <span class="code-keyword">double</span> , <span class="code-digit">3</span> &gt; state_type;
<span class="code-keyword">struct</span> harm_osc
{
    <span class="code-keyword">bool</span> direction;
    harm_osc( <span class="code-keyword">bool</span> direction_ ) : direction( direction_ ) { }
    <span class="code-keyword">void</span> <span class="code-keyword">operator</span>()( <span class="code-keyword">const</span> state_type &amp;x , state_type &amp;dxdt , <span class="code-keyword">double</span> t ) <span class="code-keyword">const</span>
    {
         dxdt[<span class="code-digit">0</span>] = ( direction ) ? x[<span class="code-digit">1</span>] : -x[<span class="code-digit">1</span>] ;
         dxdt[<span class="code-digit">1</span>] = ( direction ) ? - x[<span class="code-digit">0</span>] + cos( omega * x[<span class="code-digit">2</span>] ) : x[<span class="code-digit">0</span>] - cos( omega * x[<span class="code-digit">2</span>] );
         dxdt[<span class="code-digit">2</span>] = ( direction ) ? <span class="code-digit">1</span>.<span class="code-digit">0</span> : -<span class="code-digit">1</span>.<span class="code-digit">0</span> ;
    }
};</pre><br>
Hope this helps.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4136229" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4160980/Re-speed-question.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4160980" data-ref="3_4160980" class="rating-label" name="RateItem_4160980" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4057765_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx4057765xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container">My vote of 1<div class="mobile-only">
	<span class="author">RedDK</span><span class="date">20-Oct-11  5:55</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=660010">RedDK</a></span></td><td class="date"><span>20-Oct-11  5:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="660010" msgid="4057765" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Bad title<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4057765" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4057765/My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4057765" data-ref="3_4057765" class="rating-label" name="RateItem_4057765" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4060285_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx4060285xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4060285" parent="4057765" thread="4057765" href="https://www.codeproject.com/Messages/4060285/Re-My-vote-of.aspx">Re: My vote of 1</a><div class="mobile-only">
	<span class="author">AndyUk06</span><span class="date">24-Oct-11  4:33</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=3444843">AndyUk06</a></span></td><td class="date"><span>24-Oct-11  4:33&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="3444843" msgid="4060285" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4057765);" href="https://www.codeproject.com/Messages/4057765/My-vote-of.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>And your better suggestion is?<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4057765" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4060285/Re-My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4060285" data-ref="3_4060285" class="rating-label" name="RateItem_4060285" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4060411_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx4060411xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4060411" parent="4060285" thread="4057765" href="https://www.codeproject.com/Messages/4060411/Re-My-vote-of.aspx">Re: My vote of 1</a><div class="mobile-only">
	<span class="author">RedDK</span><span class="date">24-Oct-11  6:04</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=660010">RedDK</a></span></td><td class="date"><span>24-Oct-11  6:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="660010" msgid="4060411" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="56px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4060285);" href="https://www.codeproject.com/Messages/4060285/Re-My-vote-of.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>"Solving ordinary differential equations in C++ using BOOST on Linux"<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4057765" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4060411/Re-My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4060411" data-ref="3_4060411" class="rating-label" name="RateItem_4060411" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F4060443_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx4060443xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="4060443" parent="4060411" thread="4057765" href="https://www.codeproject.com/Messages/4060443/Re-My-vote-of.aspx">Re: My vote of 1</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">24-Oct-11  6:39</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>24-Oct-11  6:39&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="1619496" msgid="4060443" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="74px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,4060411);" href="https://www.codeproject.com/Messages/4060411/Re-My-vote-of.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>That is definitely wrong, you can compile odeint on windows.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=4057765" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/4060443/Re-My-vote-of.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF4060443" data-ref="3_4060443" class="rating-label" name="RateItem_4060443" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3468696_h0" class="header hover-row root">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="20px" class="indent"><a name="xx3468696xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_question.gif" alt="Question" title="Question"></td><td class="subject hover-container">Adaptive Example<div class="mobile-only">
	<span class="author">safariman</span><span class="date">11-May-10  7:55</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4393939">safariman</a></span></td><td class="date"><span>11-May-10  7:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content root">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4393939" msgid="3468696" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="20px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2">Thank you for this very much needed library.<br>
Can you please provide <b>example code for an adaptive integrator</b>?<br>
I try to use:<br>
<div class="pre-action-link" id="premain529121" style="width:100%;display:block;"><span id="prehide529121" onclick="processCodeBlocks.togglePre(529121);">Hide</span>  &nbsp; <span id="copycode529121" onclick="return processCodeBlocks.copyCode(529121);">Copy Code</span></div><pre id="pre529121" class="notranslate" style="margin-top: 0px;">integrate_adaptive( stepper , lorenzo , x , <span class="code-digit">0</span>.<span class="code-digit">0</span> , <span class="code-digit">10</span>.<span class="code-digit">0</span> , dt );</pre><br>
but I get a compiler error that in essence says:<br>
<div class="pre-action-link" id="premain222679" style="width:100%;display:block;"><span id="prehide222679" onclick="processCodeBlocks.togglePre(222679);">Hide</span>  &nbsp; <span id="copycode222679" onclick="return processCodeBlocks.copyCode(222679);">Copy Code</span></div><pre id="pre222679" class="notranslate" style="margin-top: 0px;">stepper_rk5_ck has no member named ‘try_step’</pre><br>
<br>
Just a very quick line or two hint on how to do this will be very helpful.<br>
Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3468696" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/3468696/Adaptive-Example.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF3468696" data-ref="3_3468696" class="rating-label" name="RateItem_3468696" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3469221_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="38px" class="indent"><a name="xx3469221xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_answer.gif" alt="Answer" title="Answer"></td><td class="subject hover-container"><a class="message-link" name="3469221" parent="3468696" thread="3468696" href="https://www.codeproject.com/Messages/3469221/Re-Adaptive-Example-modified.aspx">Re: Adaptive Example [modified]</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">11-May-10  21:02</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>11-May-10  21:02&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1619496" msgid="3469221" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="38px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,3468696);" href="https://www.codeproject.com/Messages/3468696/Adaptive-Example.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Ok, here is an example:<br>
<div class="pre-action-link" id="premain966420" style="width:100%;display:block;"><span id="prehide966420" onclick="processCodeBlocks.togglePre(966420);">Hide</span>  &nbsp; <span id="copycode966420" onclick="return processCodeBlocks.copyCode(966420);">Copy Code</span></div><pre id="pre966420" class="notranslate" style="margin-top: 0px;">typedef stepper_rk5_ck&lt; state_type <span class="code-keyword">&gt;</span> stepper_type;
controlled_stepper_standard&lt; stepper_type <span class="code-keyword">&gt;</span>
    rk5_controlled( <span class="code-digit">1</span>.0e-6 , <span class="code-digit">1</span>.0e-7 , <span class="code-digit">1</span>.<span class="code-digit">0</span> , <span class="code-digit">1</span>.<span class="code-digit">0</span> );
&nbsp;
size_t steps = integrate_adaptive( rk5_controlled , lorenz , x , <span class="code-digit">0</span>.<span class="code-digit">0</span> , <span class="code-digit">10</span>.<span class="code-digit">0</span> , <span class="code-digit">1</span>.0e-4 ,
                                   cout &lt;&lt; _1 &lt;&lt; tab &lt;&lt; _2[0] &lt;&lt; tab &lt;&lt; _2[1] &lt;&lt; <span class="code-string">"</span><span class="code-string">\n"</span> )</pre><br>
For adaptive stepsize integration you need a controlled stepper which tries to perform one step. This controlled stepper typically uses an error stepper as shown in the above expample. You can also take a look in the examples of the development branch <a href="http://svn.boost.org/svn/boost/sandbox/odeint/">sandbox/odeint</a> or the current <a href="http://svn.boost.org/svn/boost/sandbox/odeint/libs/numeric/odeint/doc/html/index.html">documentation</a>.<br>
<br>
I will update the article very soon and include a section about adaptive stepsize integration.<br>
<br>
Edit: Small fix in the example.<br>
<div class="signature"><br>
<div class="modified">modified on Friday, May 14, 2010 2:57 AM</div></div><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3468696" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/3469221/Re-Adaptive-Example-modified.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF3469221" data-ref="3_3469221" class="rating-label" name="RateItem_3469221" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3471300_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="56px" class="indent"><a name="xx3471300xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="3471300" parent="3469221" thread="3468696" href="https://www.codeproject.com/Messages/3471300/Re-Adaptive-Example.aspx">Re: Adaptive Example</a><div class="mobile-only">
	<span class="author">safariman</span><span class="date">13-May-10  6:24</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4393939">safariman</a></span></td><td class="date"><span>13-May-10  6:24&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="4393939" msgid="3471300" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="56px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,3469221);" href="https://www.codeproject.com/Messages/3469221/Re-Adaptive-Example-modified.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thank you.  The code snippet you provided works.<br>
However, when I change <br>
<div class="pre-action-link" id="premain319271" style="width:100%;display:block;"><span id="prehide319271" onclick="processCodeBlocks.togglePre(319271);">Hide</span>  &nbsp; <span id="copycode319271" onclick="return processCodeBlocks.copyCode(319271);">Copy Code</span></div><pre id="pre319271" class="notranslate" style="margin-top: 0px;">typedef stepper_rk5_ck&lt; state_type <span class="code-keyword">&gt;</span> stepper_type;</pre><br>
to<br>
<div class="pre-action-link" id="premain995518" style="width:100%;display:block;"><span id="prehide995518" onclick="processCodeBlocks.togglePre(995518);">Hide</span>  &nbsp; <span id="copycode995518" onclick="return processCodeBlocks.copyCode(995518);">Copy Code</span></div><pre id="pre995518" class="notranslate" style="margin-top: 0px;">typedef stepper_rk78_fehlberg&lt; state_type <span class="code-keyword">&gt;</span> stepper_type;</pre><br>
I get the long-winded error pasted below that basically says that rk78_fehlberg does not have function <code>do_step()</code>.  <br>
Is this a bug with my code or is controlled stepping not implemented in rk78_fehlberg yet?<br>
Thanks.<br>
<br>
<div class="pre-action-link" id="premain478947" style="width:100%;display:block;"><span id="prehide478947" onclick="processCodeBlocks.togglePre(478947);">Hide</span>  &nbsp; <span id="preShrink478947" onclick="processCodeBlocks.shrinkExpand(478947);">Expand</span> <img id="preimg478947" src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-down-16.png" style="height:16px;width:16px" onclick="processCodeBlocks.shrinkExpand(478947);">  &nbsp; <span id="copycode478947" onclick="return processCodeBlocks.copyCode(478947);">Copy Code</span></div><pre id="pre478947" shrunk="true" processed="true" class="notranslate" style="margin-top: 0px; overflow: auto; height: 400px;">/Users/philipadmin/Packages/odeint/boost/numeric/odeint/controlled_stepper_standard.hpp: In member function <span class="code-string">'</span><span class="code-string">boost::numeric::odeint::controlled_step_result boost::numeric::odeint::controlled_stepper_standard&lt;ErrorStepper&gt;::try_step(DynamicalSystem&amp;, typename ErrorStepper::container_type&amp;, const typename ErrorStepper::container_type&amp;, typename ErrorStepper::time_type&amp;, typename ErrorStepper::time_type&amp;) [with DynamicalSystem = VehicleDynamics, ErrorStepper = boost::numeric::odeint::stepper_rk78_fehlberg&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt;, double, boost::numeric::odeint::container_traits&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt; &gt;]'</span>:
/Users/philipadmin/Packages/odeint/boost/numeric/odeint/controlled_stepper_standard.hpp:<span class="code-digit">199</span>:   instantiated <span class="code-sdkkeyword">from</span> <span class="code-string">'</span><span class="code-string">boost::numeric::odeint::controlled_step_result boost::numeric::odeint::controlled_stepper_standard&lt;ErrorStepper&gt;::try_step(DynamicalSystem&amp;, typename ErrorStepper::container_type&amp;, typename ErrorStepper::time_type&amp;, typename ErrorStepper::time_type&amp;) [with DynamicalSystem = VehicleDynamics, ErrorStepper = boost::numeric::odeint::stepper_rk78_fehlberg&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt;, double, boost::numeric::odeint::container_traits&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt; &gt;]'</span>
/Users/philipadmin/Packages/odeint/boost/numeric/odeint/integrator_adaptive_stepsize.hpp:<span class="code-digit">54</span>:   instantiated <span class="code-sdkkeyword">from</span> <span class="code-string">'</span><span class="code-string">size_t boost::numeric::odeint::integrate_adaptive(ControlledStepper&amp;, DynamicalSystem&amp;, typename ControlledStepper::container_type&amp;, typename ControlledStepper::time_type, typename ControlledStepper::time_type, typename ControlledStepper::time_type, Observer&amp;) [with ControlledStepper = boost::numeric::odeint::controlled_stepper_standard&lt;boost::numeric::odeint::stepper_rk78_fehlberg&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt;, double, boost::numeric::odeint::container_traits&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt; &gt; &gt;, DynamicalSystem = VehicleDynamics, Observer = void ()(double, std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;, VehicleDynamics&amp;)]'</span>
/Users/philipadmin/Packages/odeint/boost/numeric/odeint/integrator_adaptive_stepsize.hpp:<span class="code-digit">87</span>:   instantiated <span class="code-sdkkeyword">from</span> <span class="code-string">'</span><span class="code-string">size_t boost::numeric::odeint::integrate_adaptive(ControlledStepper&amp;, DynamicalSystem&amp;, typename ControlledStepper::container_type&amp;, typename ControlledStepper::time_type, typename ControlledStepper::time_type, typename ControlledStepper::time_type) [with ControlledStepper = boost::numeric::odeint::controlled_stepper_standard&lt;boost::numeric::odeint::stepper_rk78_fehlberg&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt;, double, boost::numeric::odeint::container_traits&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt; &gt; &gt;, DynamicalSystem = VehicleDynamics]'</span>
../src/TrueVehicle.cpp:<span class="code-digit">34</span>:   instantiated <span class="code-sdkkeyword">from</span> here
/Users/philipadmin/Packages/odeint/boost/numeric/odeint/controlled_stepper_standard.hpp:<span class="code-digit">158</span>: error: no matching function <span class="code-keyword">for</span> call to <span class="code-string">'</span><span class="code-string">boost::numeric::odeint::stepper_rk78_fehlberg&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt;, double, boost::numeric::odeint::container_traits&lt;std::vector&lt;double, std::allocator&lt;double&gt; &gt; &gt; &gt;::do_step(VehicleDynamics&amp;, std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;, const std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;, double&amp;, double&amp;, std::vector&lt;double, std::allocator&lt;double&gt; &gt;&amp;)'</span>
make: *** [src/TrueVehicle.o] Error <span class="code-digit">1</span></pre><br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3468696" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/3471300/Re-Adaptive-Example.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF3471300" data-ref="3_3471300" class="rating-label" name="RateItem_3471300" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3471326_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="74px" class="indent"><a name="xx3471326xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="3471326" parent="3471300" thread="3468696" href="https://www.codeproject.com/Messages/3471326/Re-Adaptive-Example.aspx">Re: Adaptive Example</a><div class="mobile-only">
	<span class="author">headmyshoulder</span><span class="date">13-May-10  6:55</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=1619496">headmyshoulder</a></span></td><td class="date"><span>13-May-10  6:55&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:74px;"><span class="voteform vertical" ownerid="1619496" msgid="3471326" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="74px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,3471300);" href="https://www.codeproject.com/Messages/3471300/Re-Adaptive-Example.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Sry, this is bug. Thank you for finding them.<br>
<br>
The bug can be easily fixed, if you change line 365 in stepper_rk78_fehlberg.hpp into <code>const container_type &amp;dxdt ,</code>. A simple add of the <code>const</code> specifier fixes this problem. The full definition of the function should look like:<br>
<div class="pre-action-link" id="premain465" style="width:100%;display:block;"><span id="prehide465" onclick="processCodeBlocks.togglePre(465);">Hide</span>  &nbsp; <span id="copycode465" onclick="return processCodeBlocks.copyCode(465);">Copy Code</span></div><pre id="pre465" class="notranslate" style="margin-top: 0px;">template&lt; <span class="code-keyword">class</span> DynamicalSystem <span class="code-keyword">&gt;</span>
<span class="code-keyword">void</span> do_step( DynamicalSystem &amp;system ,
              container_type &amp;x ,
              <span class="code-keyword">const</span> container_type &amp;dxdt , <span class="code-comment">//</span><span class="code-comment"> don't forget the const specifier</span>
              time_type t ,
              time_type dt ,
              container_type &amp;xerr )
{
    ...
}
</pre><br>
<br>
Let me know if this works.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3468696" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/3471326/Re-Adaptive-Example.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF3471326" data-ref="3_3471326" class="rating-label" name="RateItem_3471326" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr id="F3471605_h0" class="header hover-row">
<td class="subject-line expanded " width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td width="92px" class="indent"><a name="xx3471605xx"></a><img height="16px" width="16px" align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" alt="General" title="General"></td><td class="subject hover-container"><a class="message-link" name="3471605" parent="3471326" thread="3468696" href="https://www.codeproject.com/Messages/3471605/Re-Adaptive-Example.aspx">Re: Adaptive Example</a><div class="mobile-only">
	<span class="author">safariman</span><span class="date">13-May-10  12:04</span>
</div></td><td class="icon"><img border="0" src="./Solving ordinary differential equations in C++ - CodeProject_files/icn-member-16.gif" title="member" alt="member" height="16px"></td><td class="author"><span><a href="https://www.codeproject.com/script/Membership/View.aspx?mid=4393939">safariman</a></span></td><td class="date"><span>13-May-10  12:04&nbsp;</span></td>
</tr>
</tbody></table></td>
</tr><tr class="content">
<td class="expanded" width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr valign="top">
<td class="indent align-right" style="width:92px;"><span class="voteform vertical" ownerid="4393939" msgid="3471605" votingtype="GoodOrBad"></span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" height="1px" width="92px" alt=""></td><td class="text"><table border="0" cellpadding="0" cellspacing="5px" width="100%">
<tbody><tr>
<td><table border="0" cellpadding="0" cellspacing="0" width="100%">
<tbody><tr>
<td colspan="2"><div class="parent"><a rel="nofollow" onclick="return forumControl945387.SwitchMessage(null,3471326);" href="https://www.codeproject.com/Messages/3471326/Re-Adaptive-Example.aspx"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a></div>Thanks for looking into this.<br>
I inserted <code>const</code> as you described and the code now compiles and runs.<br>
I am concerned though that the integration results are incorrect.<br>
When I use integrate_const I get the same results as MATLAB ode45 integrator.<br>
However, when I use integrate_adaptive I get integration results that very clearly not correct, even when I crank down the tolerances.<br>
I was also surprised to see that the number of steps taken is very small (six or seven) when I would expect at least 100 to get the accuracy I was asking for.<br>
<br>
Would you mind doing a quick check on your side to ensure that adaptive integration is providing you accurate results.  <br>
Thanks.<br></td>
</tr><tr class="footer" style="vertical-align:top;">
<td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/Articles/43607/Solving-ordinary-differential-equations-in-C">Sign In</a>·<wbr><a href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;tid=3468696" title="View Thread">View&nbsp;Thread</a>·<wbr><a href="https://www.codeproject.com/Messages/3471605/Re-Adaptive-Example.aspx" title="Get permanent link">Permalink</a></td><td style="text-align:right;"><span id="MVF3471605" data-ref="3_3471605" class="rating-label" name="RateItem_3471605" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table></td>
</tr><tr>
<td><img src="./Solving ordinary differential equations in C++ - CodeProject_files/t(1).gif" border="0" width="1px" height="5px" alt=""></td>
</tr><tr>
<td><table width="100%" cellpadding="2px" cellspacing="0">
<tbody><tr class="footer">
<td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99  18:00 &nbsp; &nbsp; Last Update: 3-Aug-17  17:05</span></td><td><a rel="nofollow" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Expanded">Refresh</a></td><td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Expanded&amp;fr=26"><span class="nav-link selected">1</span><a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Expanded&amp;fr=26#xx0xx">2</a> <a class="nav-link" name="Frm_HoverNL" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?fid=1551608&amp;df=90&amp;mpp=25&amp;sort=Position&amp;spc=Relaxed&amp;prof=True&amp;view=Expanded&amp;fr=26#xx0xx">Next »</a></td>
</tr>
</tbody></table></td>
</tr>
</tbody></table>
</div><p class="small-text"><img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="./Solving ordinary differential equations in C++ - CodeProject_files/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p>
				

			</div>
			
		</td>
		<td width="170px" class="article-wing-right">
			<div id="ctl00_RightSideBar" class="container-article-info">

                <div id="RHSticky" class="container-article-info-sticky" style="position: static; top: 231px; left: 1301.5px;">
        			

<div class="article-summary">

    

    

</div>

				    

				    <div style="width:160px;margin: 10px auto;">
					    <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="General-Programming/Algorithms-Recipes/Math" data-tags="C++, Windows, STL, Architect, Dev, Linux, Intermediate, Advanced,rating4.5"><noscript>&lt;a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=160x600&amp;c=965192"&gt;&lt;img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math&amp;sz=160x600&amp;c=965192"  width="160px" height="600px" target="_blank"/&gt;&lt;/a&gt;</noscript><div id="div-gpt-ad-lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math-5" data-google-query-id="CI2R27TMvNUCFR68jgodSzUPxg" style="height: 600px; width: 160px; box-sizing: border-box; border: 0px; font-size: 0px;"><div id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_2__container__" style="border: 0pt none;"><iframe id="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_2" title="3rd party ad content" name="google_ads_iframe_/6839/lqm.codeproject.site/General-Programming/Algorithms-Recipes/Math_2" width="160" height="600" scrolling="no" marginwidth="0" marginheight="0" frameborder="0" style="border: 0px; vertical-align: bottom;" src="./Solving ordinary differential equations in C++ - CodeProject_files/saved_resource(2).html"></iframe></div></div></div>
				    </div>

                    

				    

				    

				    

                    <div class="anchorLink gototop" id="gototop">
                        <a id="ctl00_GoToTop" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C#_articleTop">Go to top</a>
                    </div>

				</div>

			</div>
		</td>
		</tr></tbody></table>

		
		<div class="theme1-background" style="height:2px" id="stickyStop"></div>

		<div class="extended tiny-text">
			<div class="row">
				<div class="float-left">
					<a id="ctl00_PermaLink" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C">Permalink</a> | 
					<a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a> |
					<a id="ctl00_PrivacyLink" href="https://www.codeproject.com/info/privacy.aspx">Privacy</a> |
                    <a id="ctl00_TermsOfUseLink" href="https://www.codeproject.com/info/TermsOfUse.aspx">Terms of Use</a> |
					<a id="ctl00_Mobile">Mobile</a>
					<br>
								
					
					Web02 |
					2.8.170803.1 |
					Last Updated 19 Oct 2011								
				</div>

                <div id="ctl00_GoogleTranslate" class="translate float-left"><div class="skiptranslate goog-te-gadget" dir="ltr"><div id=":0.targetLanguage" class="goog-te-gadget-simple" style="white-space: nowrap;"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/cleardot.gif" class="goog-te-gadget-icon" alt="" style="background-image: url(&quot;https://translate.googleapis.com/translate_static/img/te_ctrl3.gif&quot;); background-position: -65px 0px;"><span style="vertical-align: middle;"><a aria-haspopup="true" class="goog-te-menu-value" href="javascript:void(0)"><span>Select Language</span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/cleardot.gif" alt="" width="1" height="1"><span style="border-left: 1px solid rgb(187, 187, 187);">​</span><img src="./Solving ordinary differential equations in C++ - CodeProject_files/cleardot.gif" alt="" width="1" height="1"><span aria-hidden="true" style="color: rgb(118, 118, 118);">▼</span></a></span></div></div></div>      

				<div class="float-right align-right">
					Article Copyright 2009 by headmyshoulder<br>Everything else
					Copyright © <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2017 <br>
				</div>

				


<div class="page-width">
Layout: <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?PageFlow=FixedWidth">fixed</a>
|
<a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="https://www.codeproject.com/Articles/43607/Solving-ordinary-differential-equations-in-C?PageFlow=Fluid">fluid</a>
</div>



			</div>
		</div>
		

		<br clear="all">
		
			

	</div> 
	</div>
</div>


<img id="ctl00_Audience" src="./Solving ordinary differential equations in C++ - CodeProject_files/DFPAudiencePixel" style="border-width:0px;height:1px;width:1px;">



<script type="text/javascript" language="Javascript" src="./Solving ordinary differential equations in C++ - CodeProject_files/article.min.js"></script>
<script type="text/javascript" language="Javascript" src="./Solving ordinary differential equations in C++ - CodeProject_files/element.js"></script>
<script type="text/javascript" language="Javascript" src="./Solving ordinary differential equations in C++ - CodeProject_files/MemberProfilePopup.min.js"></script>
<script type="text/javascript" language="Javascript">//<![CDATA[
$(document).ready(function () { processCodeBlocks.Initialise('#contentdiv'); });
function googleTranslateElementInit() {  new google.translate.TranslateElement({   pageLanguage: 'en',   layout: google.translate.TranslateElement.InlineLayout.SIMPLE,   autoDisplay: false,   gaTrack: true,   gaId: 'UA-1735123-1'},  'ctl00_GoogleTranslate');}
$(document).ready(function() { anchorAnimate();
$('#RHSticky').sticky($('#stickyStop'));
$('#ctl00_Nav').sticky($('#stickyStop'));
});
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var retrievalService=function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).bind("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};$(document).ready(function(){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new retrievalService).init()}catch(i){(new retrievalService).init()}};try{t=('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn2.developermedia.com/a.min.js';n.open("GET",t,!0);n.send()}catch(i){(new retrievalService).init()}});
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
  sbar.blur(function() {
 if (!oSrchFlt) {sfilter.hide(); sfilter.removeClass('open');}
 srchBoxFoc=false;
 });
  sbar.focus(function() {
 oSrchFlt=false; srchBoxFoc=true;
 sfilter.show(); sfilter.addClass('open');
 });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});$("#ctl00_RateArticle_RateItemWrapper")   .removeClass("container-rating")   .hover( function() { $('#ctl00_RateArticle_RSU').fadeIn('fast'); },            function() { $('#ctl00_RateArticle_RSU').fadeOut('fast'); } );
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 43607,2,1,true,true,0,'MediumStars', null, ratingAjaxCallback);
}

                        function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                            if (!$('#' + containerId).attr('alreadyRequested')){
                                $.ajax({
                                    url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId,
                                    success: function (data) {
                                        $('#' + containerId).html(data);
                                        $('#' + loadingId).hide();
                                    }
                                });
                                $('#' + containerId).attr('alreadyRequested', 'true');
                            }
                        }
$(document).ready(function() {
  new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_RB').mouseenter(function() {     getVotesHistogram(43607,2   ,'ctl00_RateArticle_Histogram','ctl00_RateArticle_Loading');
  });
})

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(){}

var config945387 = {
    objectName          : 'forumControl945387',
    messageTypeId       : 3,
    smoothScroll        : true,
    allowReporting      : false,
    allowRating         : false,
    allowRatingDisplay  : true,
    forumDir            : '/script/Forums/',
    staticServer        : 'https://codeproject.global.ssl.fastly.net',
    switchMsgCallback   : null,
    getVoteFormMethod   : getVoteFormHtml,
    getReportFormMethod : getReportFormHtml,
    voteHiThreshold     : 5 - 0.5,
    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
    getRatingRefKey     : 'obrs',
    reportOptions       : [
       { reportTypeId : 19, name : 'Abusive / Trolling'},
       { reportTypeId : 20, name : 'Inappropriate'},
       { reportTypeId : 5, name : 'Spam'},
    ],
};
var forumControl945387 = new ForumControl(config945387, -1);
$(document).ready(function() {
    forumControl945387.Initialise();
});


//]]>
</script>



<canvas id="cv1" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><canvas id="cv2" width="1px" height="1px" style="position:absolute;left:0;top:0;pointer-events:none"></canvas><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><div id="MemberProfilePopupDiv" class="raised box" style="display: none; position: absolute;"></div><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><style type="text/css">.copied::after {  position: absolute;  display: inline-block;  content: 'copied'; color: #fff; background-color: #f90;  border-radius: 3px; padding:1px 3px; opacity: 0;  will-change: opacity, transform; animation: showcopied 1.5s ease; } @keyframes showcopied { 0% { opacity: 0; transform: translateX(-100%); } 70% { opacity: 1; transform: translateX(0); } 100% { opacity: 0; } } </style><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./Solving ordinary differential equations in C++ - CodeProject_files/translate_24dp.png" width="20" height="20" alt="Google Translate"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">Original text</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">Contribute a better translation</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div><div><div class="backpack dropzone closed">
                <div class="title"></div>
                <div class="animation"></div>
                <div>Skype Backpack</div>
            </div></div><div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div><iframe frameborder="0" class="goog-te-menu-frame skiptranslate" title="Language Translate Widget" style="visibility: visible; box-sizing: content-box; width: 1007px; height: 263px; display: none;" src="./Solving ordinary differential equations in C++ - CodeProject_files/saved_resource(3).html"></iframe><script type="text/javascript">var googletag;if(typeof DMAds=="undefined"){var SendSearchTermsToServer=!0,CodeProjectPublisherId="lqm.codeproject.site",EnableMutableAds=!0,EnableViewOnScroll=!0,adServer=adServer||window.location.protocol+"//ads.DeveloperMedia.com/",SearchTermUrl=window.location.protocol+"//apps.developermedia.com/Ads/PageTerms/GetTerms",AdClickUrl=window.location.protocol+"//apps.developermedia.com/Ads/PageTerms/LogClick",DownvoteUrl=window.location.protocol+"//apps.developermedia.com/Ads/AdVote/DownvoteByFingerprint",UndoDownvoteUrl=window.location.protocol+"//apps.developermedia.com/Ads/AdVote/UndoDownvote",ReportAdUrl=window.location.protocol+"//apps.developermedia.com/Ads/AdVote/ReportAd",CloseAdImageUrl=window.location.protocol+"//apps.developermedia.com/Content/images/undo.png",UndoCloseAdImageUrl=window.location.protocol+"//apps.developermedia.com/Content/images/redo.png",DmLogoImageUrl=window.location.protocol+"//apps.developermedia.com/Content/images/dm-logo-150x23.png",GlobalIdUrl=window.location.protocol+"//apps.developermedia.com/Ads/GlobalUserIdentification/",PIIViolatingUrls=["http://www.aspsnippets.com/handlers/comments.ashx","codeproject.com/script/membership/sendpassword.aspx","http://www.dailyfreecode.com/userlogin.aspx","codeproject.com/script/membership/modify.aspx","dotnetspider.com/account/login.aspx","codeproject.com/script/membership/logon.aspx"],DMAdXHelper=function(){var i=[],n={},s=!1,r=!1,v=0,f=null,y=function(n){try{var i=p(n),t=w(n),r=b(n);t.insertBefore(r,t.children[0]);n.closeAdButton=i;n.reportAdDiv=t;n.adContainer.appendChild(i);n.adContainer.parentNode.appendChild(t);n.reportButton=t.getElementsByClassName("reportButton")[0];n.reportButton.disabled=!0;n.reportButton.onclick=function(){return l(n),!1}}catch(u){console.log(u)}},p=function(t){var i=document.createElement("input");return i.type="image",i.src=n.CloseAdImageUrl,i.title="Report Ad",i.align="left",i.style.cssText="z-index:1000; position:relative; left:0px; top:-"+t.height+"px;margin-top: 0px; margin-left: 0px; display:block; font-size:0px; border: 0px; padding: 0px; height:14px; width:14px",i.onclick=t.width==125&&t.height==125?function(){return c(t),l(t),!1}:function(){return c(t),!1},i},w=function(n){var t=n.width,i=n.height,r=document.createElement("div"),u="<select class='reportReason' style='max-width:150px !important; padding: 0px !important'><option>Offensive<\/option><option>Abusive<\/option><option>Off topic<\/option><option>Don't like the Ad<\/option><option>Wrong language<\/option><\/select>",f="<input type='button' disabled class='reportButton' style='padding: 0px !important' value='Report'><\/input>";return t==728&&i==90?k(r,u,f):t==300&&i==250?d(r,u,f):t==160&&i==600?g(r,u,f):t==125&&i==125&&nt(r),(t==728&&i==90||t==300&&i==250||t==160&&i==600)&&tt(n,r),r},b=function(t){var i=document.createElement("input");return i.type="image",i.src=n.UndoCloseAdImageUrl,i.title="Show Ad",i.style.cssText="z-index:1000; position:relative; left:0px; top:0px; width:14px; height:14px;margin-top: 0px; margin-left: 0px; font-size:0px; display:block; padding: 0px; border: 0px",i.onclick=function(){return h(t),!1},i},k=function(t,i,r){t.innerHTML="<div class='sendReportContainer' style='padding-left: 2px; display:block; line-height:initial !important'><div style='display:inline-block; font:14px/18px \"Segoe UI\", Arial'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='margin-left:10px; height:60px; width: 250px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; display:inline-block; white-space:normal'>1. Hit the refresh icon to show the ad again and take a screenshot. 2. Drag and Drop or paste the screenshot here<\/div><div style='margin-left:10px; display:inline-block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"&nbsp;"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+n.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:10px; top:10px;'><\/a>";t.style.cssText="display:none; width:728px; height:90px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},d=function(t,i,r){t.innerHTML="<div class='sendReportContainer' style='padding: 5px 5px; display:block; line-height:initial !important'><div style='padding-bottom:5px; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:100px; width: 290px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/>2. Drag and Drop or paste the screenshot here<\/div><div style='margin-top:5px; font:14px/18px \"Segoe UI\", Arial; '> "+i+"<\/div><div style='margin-top:5px; display:block; font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial; '><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+n.DmLogoImageUrl+"' style='max-width:100%;position:absolute; right:20px; bottom:10px;'><\/a>";t.style.cssText="display:none; width:300px; height:250px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},g=function(t,i,r){t.innerHTML="<div class='sendReportContainer' style='padding: 20px 15px; display:block; line-height:initial !important'><div style='padding-bottom:20px; display:block; font:14px/18px \"Segoe UI\", Arial;'><b>Don't like this Ad?<\/b><\/div><div class='dropzone' contenteditable='true' style='height:180px; width: 130px; margin-top:20px; margin-bottom: 20px; background-color:lightgray; border-style:dotted; border-color:black; border-radius: 5px; border-width: 2px; text-align: center; box-sizing:border-box; white-space:normal'>1. Hit the refresh icon to show the ad again so you can take a screenshot <br/><br/>2. Drag and Drop or paste the screenshot here<\/div><div style='padding-bottom:10px; padding-top: 10px display:block; font:14px/18px \"Segoe UI\", Arial;'> "+i+"<\/div><div style='font:14px/18px \"Segoe UI\", Arial;'>"+r+"<\/div><\/div><div class='reportSentContainer' style='display:none; padding: 15px 20px; font:14px/18px \"Segoe UI\", Arial;'><span style='color:#999;'>Thank you for the report!<\/span><\/div><a href='http://www.developermedia.com/' target='_blank'><img src='"+n.DmLogoImageUrl+"' style='max-width:120px;position:absolute; right:20px; bottom:20px;'><\/a>";t.style.cssText="display:none; width:160px; height:600px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},nt=function(n){n.innerHTML="<div class='reportSentContainer' style='padding: 5px 5px;font:14px/18px \"Segoe UI\", Arial; width: 100px; height: 100px'><span style='color:#999;'>Thank you for the report!<\/span><\/div>";n.style.cssText="display:none; width:125px; height:125px; z-index:100; text-align:left;border-style:solid; border-width:1px; position:relative; background-color:white;box-sizing:border-box; top:0px; left:0px"},tt=function(n,t){var i=t.getElementsByClassName("dropzone")[0];i.dropzoneFor=n.adContainer.id;n.dropzone=i;s&&(i.ondragenter=function(n){n.currentTarget.style.backgroundColor="yellow";n.currentTarget.innerHTML="<br/><br/>Drag and Drop the ad here"},i.ondragleave=function(n){n.currentTarget.style.backgroundColor="lightgray";u(n.currentTarget.dropzoneFor)},i.ondragover=function(n){n.stopPropagation();n.preventDefault();n.currentTarget.style.backgroundColor="yellow"},i.ondrop=function(n){n.currentTarget.style.backgroundColor="lightgreen";rt(n)});r?f?f.observe(i,{childList:!0}):i.addEventListener("DOMSubtreeModified",function(){a(i)}):i.addEventListener("paste",it,!1)},h=function(n){n.reportAdDiv.style.display==="none"?(n.reportAdDiv.style.display="table",n.closeAdButton.style.display="none",n.adContainer.style.display="none",n.dropzone.focus()):(n.reportAdDiv.style.display="none",n.closeAdButton.style.display="block",n.adContainer.style.display="block")},e=function(n){var i=t(n),r=i.dropzone;r.style.backgroundColor="lightgreen";r.innerHTML=i.width==160&&i.height==600?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":i.width==300&&i.height==250?"<br/> Your screenshot has been received – thanks! <br/><br/> Next step: What’s wrong with the ad":i.width==728&&i.height==90?"Your screenshot has been received – thanks! Next step: What’s wrong with the ad":"Ad info received. Press Report to submit"},o=function(n){var i=t(n);i.reportButton.disabled=!1},u=function(n){var i=t(n);i.reportButton.disabled=!0},c=function(n){h(n)},l=function(t){var r=t.reportAdDiv.getElementsByClassName("reportReason")[0],s=r&&r.options[r.selectedIndex].value||"Unspecified",u=t.reportAdDiv.getElementsByClassName("sendReportContainer")[0],f=t.reportAdDiv.getElementsByClassName("reportSentContainer")[0];u&&(u.style.display="none");f&&(f.style.display="block");try{var e=new XMLHttpRequest,i=new FormData,h=DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,o=null;t.fileList&&t.fileList.length>0&&(o=t.fileList[0]);e.open("POST",n.DownvoteUrl,!0);i.append("adScreenshot",o);i.append("reason",s);i.append("DmGlobalUserId",h);e.send(i)}catch(c){console.log(c)}},it=function(n){var i,h,l,s,c,a,f,v;if(!r){if(n.preventDefault(),i=[],h=!1,window.clipboardData)i=window.clipboardData.files,h=!0;else if((n.clipboardData||n.originalEvent.clipboardData)&&(l=n.clipboardData||n.originalEvent.clipboardData,s=l&&l.items||[],i=[],s&&s.length>0))for(h=!0,c=0;c<s.length;c++)a=s[c],a.kind==="file"&&(i[i.length]=a.getAsFile());f=n.currentTarget.dropzoneFor;i&&i.length>0?(v=t(f),v.fileList=i,o(f),e(f)):h?(n.currentTarget.innerHTML="<br/><br/> No files found on clipboard <br/>",u(f)):(n.currentTarget.innerHTML="<br/><br/> Paste not supported on your browser <br/>",u(f))}},rt=function(n){var f,r,i;if(n.stopPropagation(),n.preventDefault(),f=t(n.currentTarget.dropzoneFor),r=[],n.dataTransfer.files&&n.dataTransfer.files.length>0)for(i=0;i<n.dataTransfer.files.length;i++)n.dataTransfer.files[i].type&&n.dataTransfer.files[i].type.indexOf("image")>=0&&(r[r.length]=n.dataTransfer.files[i]);r.length>0?(f.fileList=r,e(n.currentTarget.dropzoneFor),o(n.currentTarget.dropzoneFor)):(n.currentTarget.style.backgroundColor="yellow",n.currentTarget.innerHTML="<br/><br/>The dropped item was not an image",u(n.currentTarget.dropzoneFor))},a=function(n){for(var t,i=0;i<n.children.length;i++)t=n.children[i],t.nodeName.toLowerCase()==="img"&&t.style.display!="none"&&t.src&&(t.style.display="none",ut(t.src,n))},ut=function(n,i){if(n){var f=n.indexOf(","),r=n.substring(0,f),s=r.indexOf(":"),h=r.indexOf(";"),c=r.substring(s+1,h),l=n.substring(f+1),a=ot(l,c,512),u=i.dropzoneFor,v=t(u);v.fileList=[a];e(u);o(u)}},ft=function(){var n=document.createElement("div");return"draggable"in n||"ondragstart"in n&&"ondrop"in n},et=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},t=function(n){for(var r,t=0,u=i.length;t<u;t++)if(i[t].adContainer.id==n){r=i[t];break}return r},ot=function(n,t,i){var e,o,r,f,s,u,h;for(t=t||"",i=i||512,e=atob(n),o=[],r=0;r<e.length;r+=i){for(f=e.slice(r,r+i),s=new Array(f.length),u=0;u<f.length;u++)s[u]=f.charCodeAt(u);h=new Uint8Array(s);o.push(h)}return new Blob(o,{type:t})};return{appendAd:function(n){i.push(n)},init:function(t,u){i=t;n=u;s=ft();r=et();r&&window.MutationObserver&&(f=new MutationObserver(function(n){n.forEach(function(n){a(n.target)})}))},showAdReportingInterface:function(n){var i=t(n);i&&y(i)},setGlobalUserId:function(n){v=n}}}(),DMUserIdentityHelper=function(){var r,t,u="dmaduid",f="dmaduid_confirm",e,o,i=[],n=0,l=function(){return navigator.cookieEnabled!=void 0?navigator.cookieEnabled:(document.cookie="testcookie=test; max-age=10000",document.cookie.indexOf("testcookie=test")>=0)},a=function(){var t=document.location.hostname,n=/([^.]+\.[^.]{3,})$/i.exec(t);return n!=null?n[1]:(n=/([^.]+\.[^.]+\.[^.]{2})$/i.exec(t),n!=null?n[1]:t)},s=function(n,t,i,r,u,f){var e="",o;e=n+"="+t;i>0&&(o=new Date,o.setTime(o.getTime()+i*864e5))&&(e+="; expires="+o.toGMTString());r&&(e+="; path="+r);u&&u.indexOf(".")!=-1&&(e+="; domain="+u);f&&(e+="; secure");document.cookie=e},h=function(n){var r=document.cookie,u=null,t,i;if(r!="")for(t=r.split(";"),index=0;index<t.length;index++)if(i=t[index].replace(/^\s+/,""),i.substring(0,n.length+1)==n+"="){u=i.substring(n.length+1);break}return u},v=function(n){var t=document.createElement("IFRAME");return t.width=1,t.height=1,t.src=e,t.id="DMGlobalUserIdetifierIFRAME",t.name="DMGlobalUserIdetifierIFRAME",t.style.display="none",document.body.appendChild(t),t.onload=n,t},y=function(){var i,l,n,a,e;if(r)if(i=h(u),l=h(f),!l&&JSON){if(n={},n.sender=location.href,n.Id=Math.random(),a=function(){o.contentWindow.postMessage(JSON.stringify(n),GlobalIdUrl)},e=function(i){var r=null,e;try{r=JSON.parse(i.data)}catch(o){}r&&r.Id&&r.Id===n.Id&&(e=r.DmGlobalUserId,s(u,e,365,"/",t,!1),s(f,r.DmGlobalUserConfirmResponse,365,"/",t,!1),c(e))},window.addEventListener)window.addEventListener("message",e,!1);else try{window.attachEvent("message",e)}catch(y){}o=v(a)}else i&&c(i)},c=function(t){for(n=t;i.length>0;){var r=i.pop();typeof r=="function"&&r()}};return{init:function(n){e=n;r=l();t=a();y()},getGlobalUserId:function(t){return n!=0?n:t?(i.push(t),n):void 0}}}(),DMAds={SetQueryTerms:function(){function u(n){for(var i,u="",t=0;t<r.length;t++)if(i=r[t],n.indexOf(i.d)>=0){u=i.q;break}return u}function f(n,t){var r=t.toLowerCase().indexOf(n),u,i;return r<0||r+n.length>=t.length?"":(u=t.indexOf("&",r),u<0&&(u=t.length),i=t.substring(r+n.length,u),i=i.replace(/\+/gi," "),i=decodeURIComponent(i),i.replace(/\"/gi,""))}function e(n){if(n===undefined)return"";var t=n.replace(/^\s+|\s+$/gi,"");return t?(t=t.replace(/\bAND\b|\bNOT\b|^NOT\b|\bOR\b|[^A-Z0-9\+\-\#\._\s]+|\b[A-Z0-9]+:/gi," "),t.replace(/\s+/g," ")):""}var r=[{d:"www.google.",q:"q="},{d:"www.bing.com",q:"q="},{d:"search.live.com",q:"q="},{d:"search.yahoo.com",q:"p="},{d:"codeproject.com",q:"q="},{d:"msdn.microsoft.com",q:"query="},{d:"www.ask.com",q:"q="},{d:"yandex.com",q:"text="},{d:"yandex.ru",q:"text="},{d:"www.baidu.com",q:"wd="},{d:"localhost",q:"q="},{d:"mkyong.com",q:"q="},{d:"codeplex.com",q:"query="},{d:"aspsnippets.com",q:"q="},{d:"trirand.com",q:"s="}],n=document.URL,i="",t=u(n);t!==""&&(i=e(f(t,n)));i==""&&(n=document.referrer.toLocaleLowerCase(),n&&(t=u(n),t!=""&&(i=e(f(t,n)))));DMAds.PageQueryTerms=i},SetPageTagsAndPixels:function(n){var t,i,r,u;if(JSON){if(DMAds.GetTermsCalled){n&&n();return}}else return;DMAds.GetTermsCalled=!0;t=document.URL;t.indexOf("?")>0&&(t=t.substring(0,t.indexOf("?")));try{i=top.document.title}catch(f){i="FAILED TO GET DOCUMENT TITLE"}r={terms:DMAds.PageQueryTerms,title:i,url:t,publisher:DMAds.PublisherCode,DmGlobalUserId:DMUserIdentityHelper&&DMUserIdentityHelper.getGlobalUserId()||0,numberOfAdsOnPage:DMAds.Ads.length};u=function(t){if(t){var i;try{i=JSON.parse(t)}catch(r){}i&&(i.SearchTerms&&(DMAds.PageTags=i.SearchTerms),i.PublisherPageViewGuid&&(DMAds.PublisherPageViewGuid=i.PublisherPageViewGuid),i.aid&&i.aid.length&&i.aid.length>0&&DMAds.InsertAudiencePixels(i.aid))}DMAds.PublisherPageViewGuid||(DMAds.PublisherPageViewGuid=1);n&&n()};DMAds.POSTJson(SearchTermUrl,r,u,!0,500)},InsertAudiencePixels:function(n){var t,i;try{for(t=0,i=n.length;t<i;t++){var r=Math.random()+"",u=r*1e13,f=new Image;f.src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord="+u+";dc_seg="+n[t]+"?"}}catch(e){}},GetRandom:function(n,t){for(var u,i="",r=0;r<n;r++)u=Math.floor(Math.random()*t).toString(t).toUpperCase(),i=i+u;return i},POSTJson:function(n,t,i,r,u){var f;if(JSON&&(f=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),f)){var s=!1,o=function(n){s||(s=!0,i&&i(n))},e=null;r&&(e=setTimeout(function(){try{f.abort()}catch(n){}o(null)},u));f.onreadystatechange=function(){try{f.readyState==4&&(e&&clearTimeout(e),f.status==200?o(f.responseText):o(null))}catch(n){e&&clearTimeout(e);o(null)}};try{f.open("POST",n,!0);f.setRequestHeader("Content-Type","application/json");f.send(JSON.stringify(t))}catch(h){e&&clearTimeout(e);o(null)}}},SignalSuccess:function(n){window.top&&window.top.postMessage&&setTimeout(function(){window.top.postMessage(n?"DM-enabled":"DM-disabled","*")},1e3)},PageQueryTerms:null,PageTags:null,Tile:1,CurrentDocument:null,PublisherCode:null,PublisherPageViewID:0,PublisherPageViewGuid:null,CreateAdsCalled:!1,GetTermsCalled:!1,Ads:[],GPTRenderingMode:-1,ShowAd:function(n){var t=DMAds.Ads,i;if(n&&(DMAds.GPTRenderingMode!=1||!DMAds.PublisherPageViewGuid))t.push(n),DMAds.GetTermsCalled||(DMAds.PublisherCode=n.sitename,DMAds.SetPageTagsAndPixels(DMAds.ShowAd));else if(DMAds.GPTRenderingMode==1&&DMAds.PublisherPageViewGuid){while(t&&t.length>0)i=t.pop(),DMAds.RequestQueuedAd(i);n&&DMAds.RequestQueuedAd(n)}},InitGPTLibrary:function(){var n=function(){typeof googletag.pubadsReady=="undefined"?(googletag.pubads().enableSingleRequest(),googletag.pubads().disableInitialLoad(),googletag.pubads().enableAsyncRendering(),googletag.enableServices(),DMAds.GPTRenderingMode=1,googletag.pubads().addEventListener("slotRenderEnded",function(n){DMAds.OnSlotRendered(n)})):DMAds.GPTRenderingMode=2};googletag.apiReady?n():googletag.cmd.push(function(){n()})},BuildIFrameTag:function(n){var t=document.createElement("IFRAME"),i;return t.allowtransparency=!1,t.id="dm-gpt-iframe-"+n.tile,t.width=n.width,t.height=n.height,t.marginWidth=0,t.marginHeight=0,t.frameBorder=0,t.scrolling="no",i=encodeURIComponent(location.href),i.length<2048&&(t.dc_ref=i),t},BuildInlineGPTTagScript:function(n){var t="div-gpt-ad-"+n.publisher+"-"+n.zone+"-"+n.tile,i="/6839/"+n.publisher+"/"+n.zone,r="["+n.width+", "+n.height+"]",u=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),f="<div id='"+t+"'>     <script type='text/javascript'>         googletag.cmd.push(function() {             googletag.defineSlot('"+i+"', "+r+",'"+t+"')                 .addService(googletag.pubads())                 .setTargeting('kw', '"+u+"');             googletag.enableServices();             googletag.display('"+t+"');         });     <\/script> <\/div>";return"<script type='text/javascript'> var googletag = googletag || {}; googletag.cmd = googletag.cmd || []; (function() {     var gads = document.createElement('script');     gads.async = true;     gads.type = 'text/javascript';     var useSSL = 'https:' == document.location.protocol;     gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';     var node =document.getElementsByTagName('script')[0];     node.parentNode.insertBefore(gads, node); })(); <\/script>"+f},BuildGPTTag:function(n){var t=document.createElement("DIV"),i;t.style.height=n.height+"px";t.style.width=n.width+"px";t.style.boxSizing="border-box";t.style.border="0px";t.style.fontSize="0px";i="div-gpt-ad-"+n.publisher+"/"+n.zone+"-"+n.tile;t.id=i;t.adIndex=n.index;n.theAdDiv.appendChild(t);n.adContainer=t;googletag.cmd.push(function(){var u="/6839/"+n.publisher+"/"+n.zone,r=(n.tags||"")+","+(DMAds.PageSearchTerms||"")+","+(DMAds.PageQueryTerms||""),t;r=DMAds.EscapeSpecialCharacters({tags:r});t=googletag.defineSlot(u,[n.width,n.height],i).setTargeting("kw",r);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(i);googletag.pubads().refresh([t],{changeCorrelator:!1})})},RequestQueuedAd:function(n){googletag.cmd.push(function(){var r="/6839/"+n.sitename+"/"+n.zonename,i=(n.tags||"")+","+(DMAds.PageSearchTerms||""),t;i=DMAds.EscapeSpecialCharacters({tags:i});t=googletag.defineSlot(r,[n.width,n.height],n.targetDivId).setTargeting("kw",i);n.articleid&&n.articleid>0&&t.setTargeting("articleid",n.articleid);t.addService(googletag.pubads());n.collapse_empty&&t.setCollapseEmptyDiv(!0,!0);googletag.display(n.targetDivId);googletag.pubads().refresh([t],{changeCorrelator:!1})})},BuildInlineGPTTag:function(n){var t=DMAds.BuildIFrameTag(n),i;n.theAdDiv.appendChild(t);i=t.contentDocument||t.contentWindow.document||t.contentWindow.window.document;i.write(DMAds.BuildInlineGPTTagScript(n))},EscapeSpecialCharacters:function(n){var t=n.tags,i;t=t.replace(/\+/gi,"{plus}");t=t.replace(/\#/gi,"{sharp}");t=t.replace(/\./gi,"{dot}");t=t.replace(/[\#\*\.\(\)\+\<\>\[\]]/gi,"");for(var r=t.split(","),u=[];r.length>0;)i=r.shift(),/[^\u0020-\u007f]/.test(i)||u.push(i);return u.join(",")},GetArticleId:function(n){var t=0,i,r;if(n&&n==CodeProjectPublisherId)try{i="Articles";r=window.location.href.indexOf(i);r>=0&&(t=window.location.href.substring(r+i.length+1),t=t.substring(0,t.indexOf("/")),t=parseInt(t),isNaN(t)&&(t=0))}catch(u){t=0}return t},IsPagePIICompliant:function(){var t=!0,i,n,r;try{for(i=window.location.href.toLowerCase(),n=0,r=PIIViolatingUrls.length;n<r&&t;n++)t=!(i.indexOf(PIIViolatingUrls[n])>=0)}catch(u){}return t},OnSlotRendered:function(n){if(window.location.href&&window.location.href.includes("show_creative_id=1")&&n&&n.creativeId&&console.log(n.creativeId),EnableMutableAds&&n&&!n.isEmpty&&(!n.lineItemId||n.lineItemId&&n.lineItemId==0))DMAdXHelper.showAdReportingInterface(n.slot.getSlotElementId());else if(n&&n.isEmpty){var t=document.getElementById(n.slot.getSlotElementId());t.style.width="0px";t.style.height="0px";t.style.display="none"}DMAds.SignalSuccess(!0)},DetermineTagSize:function(n){if(n.format){var t=n.format.split("x");t.length==2&&(n.width=parseInt(t[0]),n.height=parseInt(t[1]))}},AdjustForCodePlex:function(n){n.site&&(n.publisher="lqm.codeplex.site",n.zone=n.charity?"donated2charity":n.site.toLowerCase())},GetElementsByAttr:function(n,t,i,r){var o=[],u,e;i==null&&(i=document);r==null&&(r="*");var f=i.getElementsByTagName(r),s=f.length,h=new RegExp("(^|\\s)"+t+"(\\s|$)");for(u=0,e=0;u<s;u++)h.test(f[u].getAttribute(n))&&(o[e]=f[u],e++);return o},GetElementsByClass:function(n,t,i){var e=[],r,f;t==null&&(t=document);i==null&&(i="*");var u=t.getElementsByTagName(i),o=u.length,s=new RegExp("(^|\\s)"+n+"(\\s|$)");for(r=0,f=0;r<o;r++)s.test(u[r].className)&&(e[f]=u[r],f++);return e},SetAdRequestData:function(){var n=DMAds.GetElementsByAttr("data-type","ad",document,"div"),t;for((n==null||n.length<=0)&&(n=DMAds.GetElementsByClass("lqm_ad",document,"div")),t=0;t<n.length;t++)DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n[t],t)},GetDivRequestData:function(n,t){for(var r,f,u,o=n.attributes,s=o.length,i={},e=0;e<s;e++)r=o.item(e),r.nodeName.indexOf("lqm_")==0&&(f=r.nodeName.slice(4),i[f]=r.value||r.nodeValue),r.nodeName.indexOf("data-")==0&&(f=r.nodeName.slice(5),i[f]=r.value||r.nodeValue);return u={height:0,width:0,publisher:i.publisher,zone:i.zone,site:i.site,tags:i.tags,sitename:undefined,zonename:undefined,target:"_blank",format:i.format,index:t,tile:t+1,type:i.type,noadx:i.noadx,collapse_empty:i.collapse_empty,displayOverride:i.display||i.loadOnView,sticky:i.sticky,charity:i.charity,theAdDiv:n},u.tags&&(u.tags=decodeURIComponent(u.tags)),DMAds.DetermineTagSize(u),DMAds.AdjustForCodePlex(u),u.articleid=DMAds.GetArticleId(u.publisher),u}};if(typeof DMAds.CreateAds!="function"&&(DMAds.CreateAds=function(n){var y=this;this.PageRandomNumber=this.GetRandom(32,16);var e=function(n){var t=DMAds.Ads[n];t.rendered=!0;DMAds.GPTRenderingMode==1?DMAds.BuildGPTTag(t):DMAds.BuildInlineGPTTag(t)},l=function(n){var e=DMAds.Ads[n],h=e.theAdDiv,u=!1,i=0,r=0,t,f,o,s;try{t=h.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top==t.bottom&&(f+=e.height*-1);o=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;s=i>t.left&&t.right>=0;u=o&&s}catch(c){u=!0}return u},t=function(){for(var t,i=0,n=0;n<DMAds.Ads.length;n++)t=DMAds.Ads[n],!t.rendered&&l(n)&&u(n)&&e(n),t.rendered&&(i++,t.sticky&&!t.stickySettings&&(t.stickySettings=s(t)),c(n));i==DMAds.Ads.length&&clearInterval(f)},o=function(){var n=function(){for(var s,i,r,o=EnableViewOnScroll,n=0;n<DMAds.Ads.length;n++)s=DMAds.Ads[n],s.rendered=!1,i=s.displayOverride,i==="onscroll"||i==="true"?o=!0:(i==="always"||i==="false")&&(o=!1),!o&&u(n)&&e(n);if(t(),window.addEventListener)window.addEventListener("resize",function(){t();h()},!1),window.addEventListener("scroll",t,!1);else try{window.attachEvent("onresize",function(){t();h()});window.attachEvent("onscroll",t)}catch(c){}for(a(),r=!1,n=0;n<DMAds.Ads.length&&!r;n++)r=!u(n);r&&(f=setInterval(t,100))},i=DMAds.IsPagePIICompliant();i&&DMAds.GPTRenderingMode==-1?googletag.cmd.push(function(){n()}):i&&n()},a=function(){var n=null;typeof document.hidden!="undefined"?n="visibilitychange":typeof document.mozHidden!="undefined"?n="mozvisibilitychange":typeof document.msHidden!="undefined"?n="msvisibilitychange":typeof document.webkitHidden!="undefined"&&(n="webkitvisibilitychange");n&&document.addEventListener(n,t,!1)},s=function(n){var u=null,i,t;return n.adContainer&&(i=r(n.adContainer),t={},t.isStickyRequired=n.sticky&&n.sticky=="top",t.absoluteTop=i.y,t.absoluteLeft=i.x,t.absoluteTop!=-1&&(t.originalPosition=n.theAdDiv.style.position,u=t)),u},h=function(){for(i=0;i<DMAds.Ads.length;i++){var n=DMAds.Ads[i];n.stickySettings&&n.adContainer&&(n.adContainer.style.position=n.stickySettings.originalPosition,n.stickySettings=s(n),c(i))}},c=function(n){var t=DMAds.Ads[n].adContainer,i=DMAds.Ads[n].stickySettings,e=DMAds.Ads[n].theAdDiv,u,h,s,c,f,o;i&&i.isStickyRequired&&t.getBoundingClientRect&&document.getElementsByClassName&&(u=document.getElementsByClassName("sticky-stop")[0],u&&(h=r(u),s=u.getBoundingClientRect()),c=r(t),f=t.getBoundingClientRect(),u&&c.y+f.height+Math.abs(f.top)>h.y&&s.top<f.height?o=s.top-f.height+"px":window.pageYOffset+10>=i.absoluteTop&&(o="10px"),o?(t.style.position="fixed",t.style.top=o,t.style.left=i.absoluteLeft-window.pageXOffset+"px",e.clientHeight===0&&(e.style.height=t.clientHeight+"px"),e.clientWidth===0&&(e.style.width=t.clientWidth+"px")):t.style.position=i.originalPosition)},r=function(n){var t={};if(t.x=-1,t.y=-1,n.getBoundingClientRect){var r=n.getBoundingClientRect(),i=document.documentElement,u=window.pageYOffset||i.scrollTop||document.body.scrollTop||0,f=window.pageXOffset||i.scrollLeft||document.body.scrollLeft||0,e=i.clientTop||document.body.clientTop||0,o=i.clientLeft||document.body.clientLeft||0;t.y=r.top+u-e;t.x=r.left+f-o}return t},u=function(n){var t=DMAds.Ads[n].theAdDiv,i=!1,r;return t&&t.style.position!="fixed"&&t.offsetParent?i=!0:t&&t.style.position=="fixed"&&(r=window.getComputedStyle(t),i=r&&r.display!="none"),i&&v()},v=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!=null&&document[n]&&(t=!1),t},f=f||null;n||DMAds.CreateAdsCalled?n&&(DMAds.Ads[DMAds.Ads.length]=DMAds.GetDivRequestData(n,DMAds.Ads.length-1),DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)):(DMAds.CreateAdsCalled=!0,DMAds.SetAdRequestData(),DMAds.Ads.length>0&&(DMAds.PublisherCode=DMAds.Ads[0].publisher,DMAds.SetPageTagsAndPixels(o)))}),document.readyState==="complete")DMAds.CreateAds();else if(window.addEventListener)window.addEventListener("DOMContentLoaded",function(){DMAds.CreateAds()},!1),window.addEventListener("load",function(){DMAds.CreateAds()},!1);else try{document.attachEvent("onreadystatechange",function(){DMAds.CreateAds()});window.attachEvent("onload",function(){DMAds.CreateAds()})}catch(e){DMAds.CreateAds()}!window.googletag&&DMAds.IsPagePIICompliant()&&(googletag=googletag||{},googletag.cmd=googletag.cmd||[],function(){var n=document.createElement("script"),i,t;n.async=!0;n.type="text/javascript";i="https:"==document.location.protocol;n.src=(i?"https:":"http:")+"//www.googletagservices.com/tag/js/gpt.js";t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(n,t)}());DMAds.IsPagePIICompliant()&&(DMAds.InitGPTLibrary(),DMAds.SetQueryTerms(),DMAdXHelper.init(DMAds.Ads,{DownvoteUrl:DownvoteUrl,UndoDownvoteUrl:UndoDownvoteUrl,ReportAdUrl:ReportAdUrl,CloseAdImageUrl:CloseAdImageUrl,UndoCloseAdImageUrl:UndoCloseAdImageUrl,DmLogoImageUrl:DmLogoImageUrl}),DMUserIdentityHelper.init(GlobalIdUrl))}</script><iframe id="google_osd_static_frame_2534227109001" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;" src="./Solving ordinary differential equations in C++ - CodeProject_files/saved_resource(4).html"></iframe></body></html>